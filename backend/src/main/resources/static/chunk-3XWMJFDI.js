import{a as F,b as A,c as W,d as U,e as j,f as q}from"./chunk-PSDCBCWL.js";import{A as u,B as b,E as I,F as S,G as M,N as O,O as L,R as T,ba as E,d as h,ea as V,f as P,g as y,ga as R,h as p,i as m,ia as B,k as a,l as k,m as x,o as s,q as w,qa as z,r as n,ra as N,s as t,t as C,u as v,v as _,w as c,wa as D,y as i,z as f}from"./chunk-SDYT7PYO.js";function $(o,g){o&1&&(n(0,"div",6),C(1,"app-loading-spinner",7),t())}function Y(o,g){if(o&1&&(n(0,"div",37),i(1),t()),o&2){let e=c().$implicit;a(),u(" ",e.blockReason," ")}}function Z(o,g){if(o&1&&(n(0,"div",37),i(1),t()),o&2){let e=c().$implicit;a(),u(" ",e.scrapReason," ")}}function J(o,g){if(o&1){let e=v();n(0,"button",38),_("click",function(){p(e);let r=c().$implicit,d=c(3);return m(d.openBlockModal(r))}),i(1," Block "),t()}}function X(o,g){if(o&1){let e=v();n(0,"button",39),_("click",function(){p(e);let r=c().$implicit,d=c(3);return m(d.unblockInventory(r))}),i(1," Unblock "),t()}}function ee(o,g){if(o&1){let e=v();n(0,"button",40),_("click",function(){p(e);let r=c().$implicit,d=c(3);return m(d.openScrapModal(r))}),i(1," Scrap "),t()}}function te(o,g){o&1&&(n(0,"span",41),i(1,"-"),t())}function ne(o,g){if(o&1&&(n(0,"tr")(1,"td"),i(2),t(),n(3,"td"),i(4),t(),n(5,"td")(6,"span",29),i(7),t()(),n(8,"td"),i(9),t(),n(10,"td"),i(11),t(),n(12,"td"),C(13,"app-status-badge",30),x(14,Y,2,1,"div",31)(15,Z,2,1,"div",31),t(),n(16,"td"),i(17),t(),n(18,"td",32),x(19,J,2,0,"button",33)(20,X,2,0,"button",34)(21,ee,2,0,"button",35)(22,te,2,0,"span",36),t()()),o&2){let e=g.$implicit,l=c(3);a(2),f(e.batchNumber),a(2),f(e.materialId),a(2),w("type-"+(e.inventoryType==null?null:e.inventoryType.toLowerCase())),a(),u(" ",e.inventoryType," "),a(2),f(e.quantity),a(2),f(e.unit),a(2),s("status",e.state),a(),s("ngIf",e.state==="BLOCKED"&&e.blockReason),a(),s("ngIf",e.state==="SCRAPPED"&&e.scrapReason),a(2),f(e.location||"-"),a(2),s("ngIf",l.canBlock(e)),a(),s("ngIf",l.canUnblock(e)),a(),s("ngIf",l.canScrap(e)),a(),s("ngIf",e.state==="SCRAPPED"||e.state==="CONSUMED")}}function ie(o,g){if(o&1&&(n(0,"table",27)(1,"thead")(2,"tr")(3,"th"),i(4,"Batch Number"),t(),n(5,"th"),i(6,"Material ID"),t(),n(7,"th"),i(8,"Type"),t(),n(9,"th"),i(10,"Quantity"),t(),n(11,"th"),i(12,"UoM"),t(),n(13,"th"),i(14,"State"),t(),n(15,"th"),i(16,"Location"),t(),n(17,"th"),i(18,"Actions"),t()()(),n(19,"tbody"),x(20,ne,23,15,"tr",28),t()()),o&2){let e=c(2);a(20),s("ngForOf",e.inventory)}}function oe(o,g){o&1&&(n(0,"p",42),i(1," No inventory items found matching the selected filters. "),t())}function re(o,g){if(o&1){let e=v();n(0,"app-pagination",43),_("pageChange",function(r){p(e);let d=c(2);return m(d.onPageChange(r))})("sizeChange",function(r){p(e);let d=c(2);return m(d.onSizeChange(r))}),t()}if(o&2){let e=c(2);s("page",e.page)("size",e.size)("totalElements",e.totalElements)("totalPages",e.totalPages)("hasNext",e.hasNext)("hasPrevious",e.hasPrevious)}}function ae(o,g){if(o&1){let e=v();n(0,"div")(1,"div",8)(2,"div",9)(3,"div",10)(4,"label"),i(5,"State:"),t(),n(6,"select",11),_("change",function(r){p(e);let d=c();return m(d.onFilterStateChange(r.target.value))}),n(7,"option",12),i(8,"All States"),t(),n(9,"option",13),i(10,"Available"),t(),n(11,"option",14),i(12,"Consumed"),t(),n(13,"option",15),i(14,"On Hold"),t(),n(15,"option",16),i(16,"Blocked"),t(),n(17,"option",17),i(18,"Scrapped"),t()()(),n(19,"div",10)(20,"label"),i(21,"Type:"),t(),n(22,"select",11),_("change",function(r){p(e);let d=c();return m(d.onFilterTypeChange(r.target.value))}),n(23,"option",12),i(24,"All Types"),t(),n(25,"option",18),i(26,"Raw Material (RM)"),t(),n(27,"option",19),i(28,"Intermediate (IM)"),t(),n(29,"option",20),i(30,"Finished Goods (FG)"),t(),n(31,"option",21),i(32,"Work in Progress (WIP)"),t()()(),n(33,"div",22)(34,"label"),i(35,"Search:"),t(),n(36,"input",23),_("input",function(r){p(e);let d=c();return m(d.onSearchChange(r.target.value))}),t()()()(),n(37,"div",8),x(38,ie,21,1,"table",24)(39,oe,2,0,"p",25)(40,re,1,6,"app-pagination",26),t()()}if(o&2){let e=c();a(6),s("value",e.filterState||"all"),a(16),s("value",e.filterType||"all"),a(14),s("value",e.searchTerm),a(2),s("ngIf",e.inventory.length>0),a(),s("ngIf",e.inventory.length===0),a(),s("ngIf",e.inventory.length>0)}}function le(o,g){if(o&1&&(n(0,"div",56),i(1),t()),o&2){let e=c(2);a(),f(e.actionError)}}function ce(o,g){if(o&1){let e=v();n(0,"div",44),_("click",function(){p(e);let r=c();return m(r.closeBlockModal())}),n(1,"div",45),_("click",function(r){return p(e),m(r.stopPropagation())}),n(2,"div",46)(3,"h3"),i(4,"Block Inventory"),t(),n(5,"button",47),_("click",function(){p(e);let r=c();return m(r.closeBlockModal())}),i(6,"\xD7"),t()(),n(7,"div",48)(8,"p"),i(9,"You are about to block inventory:"),t(),n(10,"p")(11,"strong"),i(12,"Batch:"),t(),i(13),t(),n(14,"p")(15,"strong"),i(16,"Material:"),t(),i(17),t(),n(18,"p")(19,"strong"),i(20,"Quantity:"),t(),i(21),t(),n(22,"div",49)(23,"label",50),i(24,"Reason for Blocking *"),t(),n(25,"textarea",51),M("ngModelChange",function(r){p(e);let d=c();return S(d.actionReason,r)||(d.actionReason=r),m(r)}),t()(),x(26,le,2,1,"div",52),t(),n(27,"div",53)(28,"button",54),_("click",function(){p(e);let r=c();return m(r.closeBlockModal())}),i(29,"Cancel"),t(),n(30,"button",55),_("click",function(){p(e);let r=c();return m(r.confirmBlock())}),i(31),t()()()()}if(o&2){let e=c();a(13),u(" ",e.selectedInventory==null?null:e.selectedInventory.batchNumber,""),a(4),u(" ",e.selectedInventory==null?null:e.selectedInventory.materialId,""),a(4),b(" ",e.selectedInventory==null?null:e.selectedInventory.quantity," ",e.selectedInventory==null?null:e.selectedInventory.unit,""),a(4),I("ngModel",e.actionReason),a(),s("ngIf",e.actionError),a(2),s("disabled",e.actionLoading),a(2),s("disabled",e.actionLoading),a(),u(" ",e.actionLoading?"Blocking...":"Confirm Block"," ")}}function se(o,g){if(o&1&&(n(0,"div",56),i(1),t()),o&2){let e=c(2);a(),f(e.actionError)}}function de(o,g){if(o&1){let e=v();n(0,"div",44),_("click",function(){p(e);let r=c();return m(r.closeScrapModal())}),n(1,"div",45),_("click",function(r){return p(e),m(r.stopPropagation())}),n(2,"div",46)(3,"h3"),i(4,"Scrap Inventory"),t(),n(5,"button",47),_("click",function(){p(e);let r=c();return m(r.closeScrapModal())}),i(6,"\xD7"),t()(),n(7,"div",48)(8,"p",57),i(9,"Warning: Scrapping inventory is permanent and cannot be undone."),t(),n(10,"p")(11,"strong"),i(12,"Batch:"),t(),i(13),t(),n(14,"p")(15,"strong"),i(16,"Material:"),t(),i(17),t(),n(18,"p")(19,"strong"),i(20,"Quantity:"),t(),i(21),t(),n(22,"div",49)(23,"label",58),i(24,"Reason for Scrapping *"),t(),n(25,"textarea",59),M("ngModelChange",function(r){p(e);let d=c();return S(d.actionReason,r)||(d.actionReason=r),m(r)}),t()(),x(26,se,2,1,"div",52),t(),n(27,"div",53)(28,"button",54),_("click",function(){p(e);let r=c();return m(r.closeScrapModal())}),i(29,"Cancel"),t(),n(30,"button",60),_("click",function(){p(e);let r=c();return m(r.confirmScrap())}),i(31),t()()()()}if(o&2){let e=c();a(13),u(" ",e.selectedInventory==null?null:e.selectedInventory.batchNumber,""),a(4),u(" ",e.selectedInventory==null?null:e.selectedInventory.materialId,""),a(4),b(" ",e.selectedInventory==null?null:e.selectedInventory.quantity," ",e.selectedInventory==null?null:e.selectedInventory.unit,""),a(4),I("ngModel",e.actionReason),a(),s("ngIf",e.actionError),a(2),s("disabled",e.actionLoading),a(2),s("disabled",e.actionLoading),a(),u(" ",e.actionLoading?"Scrapping...":"Confirm Scrap"," ")}}var K=(()=>{class o{constructor(e){this.apiService=e,this.inventory=[],this.loading=!0,this.page=0,this.size=20,this.totalElements=0,this.totalPages=0,this.hasNext=!1,this.hasPrevious=!1,this.filterState="",this.filterType="",this.searchTerm="",this.showBlockModal=!1,this.showScrapModal=!1,this.selectedInventory=null,this.actionReason="",this.actionLoading=!1,this.actionError=""}ngOnInit(){this.loadInventory()}loadInventory(){this.loading=!0;let e={page:this.page,size:this.size,sortBy:"createdOn",sortDirection:"DESC",status:this.filterState||void 0,type:this.filterType||void 0,search:this.searchTerm||void 0};this.apiService.getInventoryPaged(e).subscribe({next:l=>{this.inventory=l.content,this.page=l.page,this.size=l.size,this.totalElements=l.totalElements,this.totalPages=l.totalPages,this.hasNext=l.hasNext,this.hasPrevious=l.hasPrevious,this.loading=!1},error:l=>{console.error("Error loading inventory:",l),this.loading=!1}})}onPageChange(e){this.page=e,this.loadInventory()}onSizeChange(e){this.size=e,this.page=0,this.loadInventory()}onFilterStateChange(e){this.filterState=e==="all"?"":e,this.page=0,this.loadInventory()}onFilterTypeChange(e){this.filterType=e==="all"?"":e,this.page=0,this.loadInventory()}onSearchChange(e){this.searchTerm=e,this.page=0,this.loadInventory()}openBlockModal(e){this.selectedInventory=e,this.actionReason="",this.actionError="",this.showBlockModal=!0}closeBlockModal(){this.showBlockModal=!1,this.selectedInventory=null,this.actionReason="",this.actionError=""}confirmBlock(){if(!this.actionReason.trim()){this.actionError="Please provide a reason for blocking.";return}this.selectedInventory&&(this.actionLoading=!0,this.actionError="",this.apiService.blockInventory(this.selectedInventory.inventoryId,this.actionReason).subscribe({next:()=>{this.actionLoading=!1,this.closeBlockModal(),this.loadInventory()},error:e=>{this.actionLoading=!1,this.actionError=e.error?.message||"Failed to block inventory."}}))}unblockInventory(e){confirm(`Are you sure you want to unblock inventory ${e.batchNumber}?`)&&(this.loading=!0,this.apiService.unblockInventory(e.inventoryId).subscribe({next:()=>{this.loadInventory()},error:l=>{this.loading=!1,alert(l.error?.message||"Failed to unblock inventory.")}}))}openScrapModal(e){this.selectedInventory=e,this.actionReason="",this.actionError="",this.showScrapModal=!0}closeScrapModal(){this.showScrapModal=!1,this.selectedInventory=null,this.actionReason="",this.actionError=""}confirmScrap(){if(!this.actionReason.trim()){this.actionError="Please provide a reason for scrapping.";return}this.selectedInventory&&(this.actionLoading=!0,this.actionError="",this.apiService.scrapInventory(this.selectedInventory.inventoryId,this.actionReason).subscribe({next:()=>{this.actionLoading=!1,this.closeScrapModal(),this.loadInventory()},error:e=>{this.actionLoading=!1,this.actionError=e.error?.message||"Failed to scrap inventory."}}))}canBlock(e){return e.state!=="BLOCKED"&&e.state!=="CONSUMED"&&e.state!=="SCRAPPED"}canUnblock(e){return e.state==="BLOCKED"}canScrap(e){return e.state!=="CONSUMED"&&e.state!=="SCRAPPED"}static{this.\u0275fac=function(l){return new(l||o)(k(F))}}static{this.\u0275cmp=P({type:o,selectors:[["app-inventory-list"]],decls:9,vars:4,consts:[[1,"container"],[1,"page-header"],[1,"page-title"],["class","text-center",4,"ngIf"],[4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"text-center"],["message","Loading inventory..."],[1,"card"],[1,"filters"],[1,"filter-group"],[3,"change","value"],["value","all"],["value","AVAILABLE"],["value","CONSUMED"],["value","ON_HOLD"],["value","BLOCKED"],["value","SCRAPPED"],["value","RM"],["value","IM"],["value","FG"],["value","WIP"],[1,"filter-group","search-group"],["type","text","placeholder","Search by batch or material...",3,"input","value"],["class","table",4,"ngIf"],["class","no-data",4,"ngIf"],[3,"page","size","totalElements","totalPages","hasNext","hasPrevious","pageChange","sizeChange",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],[1,"type-badge"],[3,"status"],["class","reason-text",4,"ngIf"],[1,"actions-cell"],["class","btn btn-small btn-warning",3,"click",4,"ngIf"],["class","btn btn-small btn-success",3,"click",4,"ngIf"],["class","btn btn-small btn-danger",3,"click",4,"ngIf"],["class","no-actions",4,"ngIf"],[1,"reason-text"],[1,"btn","btn-small","btn-warning",3,"click"],[1,"btn","btn-small","btn-success",3,"click"],[1,"btn","btn-small","btn-danger",3,"click"],[1,"no-actions"],[1,"no-data"],[3,"pageChange","sizeChange","page","size","totalElements","totalPages","hasNext","hasPrevious"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"form-group"],["for","blockReason"],["id","blockReason","placeholder","Enter reason for blocking this inventory...","rows","3",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"btn","btn-warning",3,"click","disabled"],[1,"error-message"],[1,"warning-text"],["for","scrapReason"],["id","scrapReason","placeholder","Enter reason for scrapping this inventory...","rows","3",3,"ngModelChange","ngModel"],[1,"btn","btn-danger",3,"click","disabled"]],template:function(l,r){l&1&&(C(0,"app-header"),n(1,"div",0)(2,"div",1)(3,"h1",2),i(4,"Inventory"),t()(),x(5,$,2,0,"div",3)(6,ae,41,6,"div",4),t(),x(7,ce,32,9,"div",5)(8,de,32,9,"div",5)),l&2&&(a(5),s("ngIf",r.loading),a(),s("ngIf",!r.loading),a(),s("ngIf",r.showBlockModal),a(),s("ngIf",r.showScrapModal))},dependencies:[O,L,z,N,V,R,B,A,W,U,j],styles:[".summary-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px;flex-wrap:wrap}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:16px 24px;display:flex;flex-direction:column;align-items:center;min-width:120px}.summary-label[_ngcontent-%COMP%]{font-size:12px;color:#888;text-transform:uppercase}.summary-value[_ngcontent-%COMP%]{font-size:24px;font-weight:500;color:#333}.filters[_ngcontent-%COMP%]{display:flex;gap:24px;flex-wrap:wrap}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:#666}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2}.search-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:250px}.type-badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 8px;border-radius:4px;font-size:12px;font-weight:500}.type-rm[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1565c0}.type-im[_ngcontent-%COMP%]{background-color:#fff3e0;color:#e65100}.type-fg[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.type-wip[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.no-data[_ngcontent-%COMP%]{text-align:center;color:#888;padding:40px}.actions-cell[_ngcontent-%COMP%]{white-space:nowrap}.btn-small[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px;margin-right:4px}.btn-warning[_ngcontent-%COMP%]{background-color:#ff9800;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#f57c00}.btn-success[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-success[_ngcontent-%COMP%]:hover{background-color:#388e3c}.btn-danger[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#d32f2f}.btn-secondary[_ngcontent-%COMP%]{background-color:#9e9e9e;color:#fff;border:none;border-radius:4px;cursor:pointer;padding:8px 16px}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#757575}.no-actions[_ngcontent-%COMP%]{color:#999}.reason-text[_ngcontent-%COMP%]{font-size:11px;color:#666;margin-top:4px;font-style:italic}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:100%;max-width:500px;box-shadow:0 4px 20px #00000026}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #e0e0e0}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#999}.close-btn[_ngcontent-%COMP%]:hover{color:#333}.modal-body[_ngcontent-%COMP%]{padding:20px}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0}.form-group[_ngcontent-%COMP%]{margin-top:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;resize:vertical}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px 20px;border-top:1px solid #e0e0e0}.modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px}.warning-text[_ngcontent-%COMP%]{color:#c62828;font-weight:500;background-color:#ffebee;padding:10px;border-radius:4px;margin-bottom:16px}.error-message[_ngcontent-%COMP%]{color:#c62828;background-color:#ffebee;padding:10px;border-radius:4px;margin-top:16px}@media (max-width: 768px){.filters[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.search-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.modal[_ngcontent-%COMP%]{margin:20px}}"]})}}return o})();var pe=[{path:"",component:K}],H=(()=>{class o{static{this.\u0275fac=function(l){return new(l||o)}}static{this.\u0275mod=y({type:o})}static{this.\u0275inj=h({imports:[E.forChild(pe),E]})}}return o})();var Oe=(()=>{class o{static{this.\u0275fac=function(l){return new(l||o)}}static{this.\u0275mod=y({type:o})}static{this.\u0275inj=h({imports:[T,D,H,q]})}}return o})();export{Oe as InventoryModule};

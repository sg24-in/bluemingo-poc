import{h as I,i as G,j as ae,k as re,n as le}from"./chunk-LMWWBC6Z.js";import{$ as J,$a as oe,Aa as V,B as s,Ba as ee,D as y,Da as Q,F as n,G as t,H as x,Ha as A,Ia as b,Ja as L,Ka as D,L as C,La as te,M as g,Ma as F,N as d,Na as ne,Pa as z,Sa as B,T as o,Ta as $,U as h,Ua as q,V as _,Va as j,W as w,Xa as ie,Z as W,Za as U,_ as Z,da as M,fa as H,ia as k,ja as N,ka as O,m as P,o as S,oa as R,p as T,qa as K,r as f,s as u,w as r,x as v,ya as X,z as m}from"./chunk-SXRLIX2W.js";function xe(i,p){if(i&1&&(n(0,"div",12),o(1),t()),i&2){let e=d();r(),h(e.error)}}function ve(i,p){if(i&1&&(n(0,"div",13),o(1),t()),i&2){let e=d();r(),h(e.success)}}function ye(i,p){i&1&&(n(0,"div",14),x(1,"app-loading-spinner",15),t())}function Ce(i,p){if(i&1){let e=C();n(0,"button",40),g("click",function(){f(e);let l=d().$implicit,c=d(3);return u(c.openReleaseHoldModal(l))}),o(1," Release "),t()}}function be(i,p){i&1&&(n(0,"span",41),o(1,"-"),t())}function Ee(i,p){if(i&1&&(n(0,"tr")(1,"td")(2,"span",36),o(3),t()(),n(4,"td"),o(5),t(),n(6,"td"),o(7),t(),n(8,"td"),x(9,"app-status-badge",37),t(),n(10,"td"),o(11),t(),n(12,"td"),o(13),M(14,"date"),t(),n(15,"td"),o(16),t(),n(17,"td"),m(18,Ce,2,0,"button",38)(19,be,2,0,"span",39),t()()),i&2){let e=p.$implicit,a=d(3);r(2),s("ngClass",e.entityType.toLowerCase()),r(),_(" ",e.entityType," "),r(2),h(e.entityName),r(2),h(e.reason),r(2),s("status",e.status),r(2),h(e.appliedBy),r(2),h(H(14,10,e.appliedOn,"short")),r(3),h(a.formatDuration(e.durationMinutes)),r(2),s("ngIf",e.status==="ACTIVE"),r(),s("ngIf",e.status!=="ACTIVE")}}function Se(i,p){if(i&1&&(n(0,"table",34)(1,"thead")(2,"tr")(3,"th"),o(4,"Entity Type"),t(),n(5,"th"),o(6,"Entity"),t(),n(7,"th"),o(8,"Reason"),t(),n(9,"th"),o(10,"Status"),t(),n(11,"th"),o(12,"Applied By"),t(),n(13,"th"),o(14,"Applied On"),t(),n(15,"th"),o(16,"Duration"),t(),n(17,"th"),o(18,"Actions"),t()()(),n(19,"tbody"),m(20,Ee,20,13,"tr",35),t()()),i&2){let e=d(2);r(20),s("ngForOf",e.holds)}}function Oe(i,p){i&1&&(n(0,"p",42),o(1," No holds found matching the selected filters. "),t())}function Ie(i,p){if(i&1){let e=C();n(0,"app-pagination",43),g("pageChange",function(l){f(e);let c=d(2);return u(c.onPageChange(l))})("sizeChange",function(l){f(e);let c=d(2);return u(c.onSizeChange(l))}),t()}if(i&2){let e=d(2);s("page",e.page)("size",e.size)("totalElements",e.totalElements)("totalPages",e.totalPages)("hasNext",e.hasNext)("hasPrevious",e.hasPrevious)}}function Me(i,p){if(i&1){let e=C();n(0,"div")(1,"div",16)(2,"div",17)(3,"div",18)(4,"label"),o(5,"Status:"),t(),n(6,"select",19),g("change",function(l){f(e);let c=d();return u(c.onFilterStatusChange(l.target.value))}),n(7,"option",20),o(8,"All Statuses"),t(),n(9,"option",21),o(10,"Active"),t(),n(11,"option",22),o(12,"Released"),t()()(),n(13,"div",18)(14,"label"),o(15,"Entity Type:"),t(),n(16,"select",19),g("change",function(l){f(e);let c=d();return u(c.onFilterEntityTypeChange(l.target.value))}),n(17,"option",20),o(18,"All Types"),t(),n(19,"option",23),o(20,"Operation"),t(),n(21,"option",24),o(22,"Process"),t(),n(23,"option",25),o(24,"Order Line"),t(),n(25,"option",26),o(26,"Inventory"),t(),n(27,"option",27),o(28,"Batch"),t(),n(29,"option",28),o(30,"Equipment"),t()()(),n(31,"div",29)(32,"label"),o(33,"Search:"),t(),n(34,"input",30),g("input",function(l){f(e);let c=d();return u(c.onSearchChange(l.target.value))}),t()()()(),n(35,"div",16),m(36,Se,21,1,"table",31)(37,Oe,2,0,"p",32)(38,Ie,1,6,"app-pagination",33),t()()}if(i&2){let e=d();r(3),y("filter-active",e.filterStatus&&e.filterStatus!=="all"),r(3),y("filter-active",e.filterStatus&&e.filterStatus!=="all"),s("value",e.filterStatus||"all"),r(7),y("filter-active",e.filterEntityType&&e.filterEntityType!=="all"),r(3),y("filter-active",e.filterEntityType&&e.filterEntityType!=="all"),s("value",e.filterEntityType||"all"),r(18),s("value",e.searchTerm),r(2),s("ngIf",e.holds.length>0),r(),s("ngIf",e.holds.length===0),r(),s("ngIf",e.holds.length>0)}}function He(i,p){if(i&1&&(n(0,"option",64),o(1),t()),i&2){let e=p.$implicit;s("value",e.value),r(),_(" ",e.label," ")}}function Pe(i,p){if(i&1&&(n(0,"option",64),o(1),t()),i&2){let e=p.$implicit;s("value",e.id),r(),_(" ",e.name," ")}}function Te(i,p){if(i&1&&(n(0,"div",51)(1,"label",65),o(2,"Entity *"),t(),n(3,"select",66)(4,"option",54),o(5,"Select entity"),t(),m(6,Pe,2,2,"option",55),t()()),i&2){let e=d(2);r(6),s("ngForOf",e.getEntityOptions())}}function we(i,p){if(i&1&&(n(0,"option",64),o(1),t()),i&2){let e=p.$implicit;s("value",e.reasonCode),r(),_(" ",e.reasonDescription," ")}}function ke(i,p){if(i&1){let e=C();n(0,"div",44),g("click",function(){f(e);let l=d();return u(l.closeApplyHoldModal())}),n(1,"div",45),g("click",function(l){return f(e),u(l.stopPropagation())}),n(2,"div",46)(3,"h3"),o(4,"Apply Hold"),t(),n(5,"button",47),g("click",function(){f(e);let l=d();return u(l.closeApplyHoldModal())}),x(6,"i",48),t()(),n(7,"form",49),g("ngSubmit",function(){f(e);let l=d();return u(l.applyHold())}),n(8,"div",50)(9,"div",51)(10,"label",52),o(11,"Entity Type *"),t(),n(12,"select",53)(13,"option",54),o(14,"Select entity type"),t(),m(15,He,2,2,"option",55),t()(),m(16,Te,7,1,"div",56),n(17,"div",51)(18,"label",57),o(19,"Reason *"),t(),n(20,"select",58)(21,"option",54),o(22,"Select reason"),t(),m(23,we,2,2,"option",55),t()(),n(24,"div",51)(25,"label",59),o(26,"Comments"),t(),x(27,"textarea",60),t()(),n(28,"div",61)(29,"button",62),g("click",function(){f(e);let l=d();return u(l.closeApplyHoldModal())}),o(30,"Cancel"),t(),n(31,"button",63),o(32," Apply Hold "),t()()()()()}if(i&2){let e,a=d();r(7),s("formGroup",a.applyHoldForm),r(8),s("ngForOf",a.entityTypes),r(),s("ngIf",(e=a.applyHoldForm.get("entityType"))==null?null:e.value),r(7),s("ngForOf",a.holdReasons),r(8),s("disabled",a.applyHoldForm.invalid||a.loading)}}function Ne(i,p){if(i&1&&(n(0,"div",71)(1,"p")(2,"strong"),o(3,"Entity:"),t(),o(4),t(),n(5,"p")(6,"strong"),o(7,"Reason:"),t(),o(8),t(),n(9,"p")(10,"strong"),o(11,"Applied By:"),t(),o(12),t(),n(13,"p")(14,"strong"),o(15,"Duration:"),t(),o(16),t()()),i&2){let e=d(2);r(4),w(" ",e.selectedHold.entityType," - ",e.selectedHold.entityName,""),r(4),_(" ",e.selectedHold.reason,""),r(4),_(" ",e.selectedHold.appliedBy,""),r(4),_(" ",e.formatDuration(e.selectedHold.durationMinutes),"")}}function Re(i,p){if(i&1){let e=C();n(0,"div",44),g("click",function(){f(e);let l=d();return u(l.closeReleaseHoldModal())}),n(1,"div",45),g("click",function(l){return f(e),u(l.stopPropagation())}),n(2,"div",46)(3,"h3"),o(4,"Release Hold"),t(),n(5,"button",47),g("click",function(){f(e);let l=d();return u(l.closeReleaseHoldModal())}),x(6,"i",48),t()(),n(7,"div",50),m(8,Ne,17,5,"div",67),n(9,"div",51)(10,"label",68),o(11,"Release Comments"),t(),n(12,"textarea",69),J("ngModelChange",function(l){f(e);let c=d();return Z(c.releaseComments,l)||(c.releaseComments=l),u(l)}),t()()(),n(13,"div",61)(14,"button",62),g("click",function(){f(e);let l=d();return u(l.closeReleaseHoldModal())}),o(15,"Cancel"),t(),n(16,"button",70),g("click",function(){f(e);let l=d();return u(l.releaseHold())}),o(17," Release Hold "),t()()()()}if(i&2){let e=d();r(8),s("ngIf",e.selectedHold),r(4),W("ngModel",e.releaseComments),r(4),s("disabled",e.loading)}}var ce=(()=>{class i{constructor(e,a){this.apiService=e,this.fb=a,this.holds=[],this.holdReasons=[],this.loading=!1,this.error="",this.success="",this.page=0,this.size=20,this.totalElements=0,this.totalPages=0,this.hasNext=!1,this.hasPrevious=!1,this.filterStatus="",this.filterEntityType="",this.searchTerm="",this.showApplyHoldModal=!1,this.showReleaseHoldModal=!1,this.selectedHold=null,this.releaseComments="",this.entityTypes=[{value:"OPERATION",label:"Operation"},{value:"PROCESS",label:"Process"},{value:"ORDER_LINE",label:"Order Line"},{value:"INVENTORY",label:"Inventory"},{value:"BATCH",label:"Batch"}],this.operations=[],this.processes=[],this.inventory=[],this.batches=[],this.applyHoldForm=this.fb.group({entityType:["",b.required],entityId:["",b.required],reason:["",b.required],comments:[""]})}ngOnInit(){this.loadHolds(),this.loadHoldReasons(),this.loadEntities()}loadHolds(){this.loading=!0;let e={page:this.page,size:this.size,sortBy:"appliedOn",sortDirection:"DESC",status:this.filterStatus||void 0,type:this.filterEntityType||void 0,search:this.searchTerm||void 0};this.apiService.getHoldsPaged(e).subscribe({next:a=>{this.holds=a.content,this.page=a.page,this.size=a.size,this.totalElements=a.totalElements,this.totalPages=a.totalPages,this.hasNext=a.hasNext,this.hasPrevious=a.hasPrevious,this.loading=!1},error:a=>{console.error("Error loading holds:",a),this.error="Failed to load holds",this.loading=!1}})}onPageChange(e){this.page=e,this.loadHolds()}onSizeChange(e){this.size=e,this.page=0,this.loadHolds()}onFilterStatusChange(e){this.filterStatus=e==="all"?"":e,this.page=0,this.loadHolds()}onFilterEntityTypeChange(e){this.filterEntityType=e==="all"?"":e,this.page=0,this.loadHolds()}onSearchChange(e){this.searchTerm=e,this.page=0,this.loadHolds()}loadHoldReasons(){this.apiService.getHoldReasons().subscribe({next:e=>{this.holdReasons=e},error:e=>console.error("Error loading hold reasons:",e)})}loadEntities(){this.apiService.getAvailableOrders().subscribe({next:e=>{this.operations=[],e.forEach(a=>{a.lineItems?.forEach(l=>{l.processes?.forEach(c=>{c.operations?.forEach(E=>{E.status!=="ON_HOLD"&&E.status!=="CONFIRMED"&&this.operations.push({id:E.operationId,name:`${E.operationName} (Order: ${a.orderId})`})}),c.status!=="ON_HOLD"&&c.status!=="COMPLETED"&&this.processes.push({id:c.processId,name:`${c.processName} (Order: ${a.orderId})`})})})})},error:e=>console.error("Error loading operations:",e)}),this.apiService.getAllInventory().subscribe({next:e=>{this.inventory=e.filter(a=>a.state!=="ON_HOLD"&&a.state!=="CONSUMED").map(a=>({id:a.inventoryId,name:`${a.materialId} - ${a.materialName} (${a.quantity} ${a.unit})`}))},error:e=>console.error("Error loading inventory:",e)}),this.apiService.getAllBatches().subscribe({next:e=>{this.batches=e.filter(a=>a.status!=="ON_HOLD"&&a.status!=="CONSUMED").map(a=>({id:a.batchId,name:`${a.batchNumber} - ${a.materialName}`}))},error:e=>console.error("Error loading batches:",e)})}getEntityOptions(){switch(this.applyHoldForm.get("entityType")?.value){case"OPERATION":return this.operations;case"PROCESS":return this.processes;case"INVENTORY":return this.inventory;case"BATCH":return this.batches;default:return[]}}openApplyHoldModal(){this.applyHoldForm.reset(),this.showApplyHoldModal=!0,this.error="",this.success=""}closeApplyHoldModal(){this.showApplyHoldModal=!1}openReleaseHoldModal(e){this.selectedHold=e,this.releaseComments="",this.showReleaseHoldModal=!0,this.error="",this.success=""}closeReleaseHoldModal(){this.showReleaseHoldModal=!1,this.selectedHold=null}applyHold(){if(this.applyHoldForm.invalid)return;let e=this.applyHoldForm.value;this.loading=!0,this.error="",this.apiService.applyHold(e).subscribe({next:()=>{this.success="Hold applied successfully",this.closeApplyHoldModal(),this.loadHolds(),this.loadEntities(),this.loading=!1},error:a=>{console.error("Error applying hold:",a),this.error=a.error?.message||"Failed to apply hold",this.loading=!1}})}releaseHold(){this.selectedHold&&(this.loading=!0,this.error="",this.apiService.releaseHold(this.selectedHold.holdId,this.releaseComments).subscribe({next:()=>{this.success="Hold released successfully",this.closeReleaseHoldModal(),this.loadHolds(),this.loadEntities(),this.loading=!1},error:e=>{console.error("Error releasing hold:",e),this.error=e.error?.message||"Failed to release hold",this.loading=!1}}))}formatDuration(e){if(!e)return"-";let a=Math.floor(e/60),l=e%60;return a>0?`${a}h ${l}m`:`${l}m`}static{this.\u0275fac=function(a){return new(a||i)(v(I),v(U))}}static{this.\u0275cmp=S({type:i,selectors:[["app-hold-list"]],decls:16,vars:6,consts:[[1,"container"],[1,"page-header"],[1,"page-title"],[1,"header-actions"],["routerLink","/holds/new",1,"btn","btn-secondary"],[1,"fa","fa-plus"],[1,"btn","btn-primary",3,"click"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","text-center",4,"ngIf"],[4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"text-center"],["message","Loading holds..."],[1,"card"],[1,"filters"],[1,"filter-group"],[3,"change","value"],["value","all"],["value","ACTIVE"],["value","RELEASED"],["value","OPERATION"],["value","PROCESS"],["value","ORDER_LINE"],["value","INVENTORY"],["value","BATCH"],["value","EQUIPMENT"],[1,"filter-group","search-group"],["type","text","placeholder","Search by reason or comments...",3,"input","value"],["class","table",4,"ngIf"],["class","no-data",4,"ngIf"],[3,"page","size","totalElements","totalPages","hasNext","hasPrevious","pageChange","sizeChange",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],[1,"entity-type-badge",3,"ngClass"],[3,"status"],["class","btn btn-sm btn-success",3,"click",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"text-muted"],[1,"no-data"],[3,"pageChange","sizeChange","page","size","totalElements","totalPages","hasNext","hasPrevious"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"fas","fa-xmark"],[3,"ngSubmit","formGroup"],[1,"modal-body"],[1,"form-group"],["for","entityType"],["id","entityType","formControlName","entityType"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["for","reason"],["id","reason","formControlName","reason"],["for","comments"],["id","comments","formControlName","comments","rows","3"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-warning",3,"disabled"],[3,"value"],["for","entityId"],["id","entityId","formControlName","entityId"],["class","hold-details",4,"ngIf"],["for","releaseComments"],["id","releaseComments","rows","3",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"hold-details"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),o(3,"Hold Management"),t(),n(4,"div",3)(5,"button",4),x(6,"i",5),o(7," New Hold "),t(),n(8,"button",6),g("click",function(){return l.openApplyHoldModal()}),o(9," Apply Hold "),t()()(),m(10,xe,2,1,"div",7)(11,ve,2,1,"div",8)(12,ye,2,0,"div",9)(13,Me,39,14,"div",10),t(),m(14,ke,33,5,"div",11)(15,Re,18,3,"div",11)),a&2&&(r(10),s("ngIf",l.error),r(),s("ngIf",l.success),r(),s("ngIf",l.loading),r(),s("ngIf",!l.loading),r(),s("ngIf",l.showApplyHoldModal),r(),s("ngIf",l.showReleaseHoldModal))},dependencies:[k,N,O,F,q,j,A,$,L,D,z,B,ee,te,G,ae,re,R],styles:[".hold-list-container[_ngcontent-%COMP%]{padding:20px}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.page-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#333}.holds-table[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;overflow:hidden}.holds-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.holds-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .holds-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;text-align:left;border-bottom:1px solid #e0e0e0}.holds-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:600;color:#333}.holds-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#fafafa}.entity-type-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500;text-transform:uppercase}.entity-type-badge.operation[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.entity-type-badge.process[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.entity-type-badge.order_line[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.entity-type-badge.inventory[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#388e3c}.entity-type-badge.batch[_ngcontent-%COMP%]{background-color:#fce4ec;color:#c2185b}.entity-type-badge.equipment[_ngcontent-%COMP%]{background-color:#e0f2f1;color:#00796b}.hold-details[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:16px;border-radius:4px;margin-bottom:16px}.hold-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px}@media (max-width: 768px){.hold-list-container[_ngcontent-%COMP%]{padding:16px}.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.holds-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .holds-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 12px;font-size:13px}}"]})}}return i})();function Ve(i,p){if(i&1&&(n(0,"div",25),o(1),t()),i&2){let e=d();r(),h(e.error)}}function Ae(i,p){if(i&1&&(n(0,"option",26),o(1),t()),i&2){let e=p.$implicit,a=d();s("value",e),r(),h(a.getEntityTypeLabel(e))}}function Le(i,p){i&1&&(n(0,"span",27),o(1,"Entity type is required"),t())}function De(i,p){i&1&&(n(0,"span",27),o(1,"Valid entity ID is required"),t())}function Fe(i,p){if(i&1&&(n(0,"option",26),o(1),t()),i&2){let e=p.$implicit;s("value",e.reasonCode),r(),w("",e.description," (",e.reasonCode,")")}}function ze(i,p){i&1&&(n(0,"span",28),o(1,"Loading reasons..."),t())}function Be(i,p){i&1&&(n(0,"span",27),o(1,"Hold reason is required"),t())}function $e(i,p){i&1&&(n(0,"span"),o(1,"Applying..."),t())}function qe(i,p){i&1&&(n(0,"span"),x(1,"i",29),o(2," Apply Hold"),t())}var me=(()=>{class i{constructor(e,a,l){this.fb=e,this.apiService=a,this.router=l,this.saving=!1,this.error="",this.entityTypes=["ORDER","OPERATION","BATCH","INVENTORY","EQUIPMENT"],this.holdReasons=[],this.loadingReasons=!0}ngOnInit(){this.form=this.fb.group({entityType:["",b.required],entityId:["",[b.required,b.min(1)]],reason:["",b.required],comments:[""]}),this.loadHoldReasons()}loadHoldReasons(){this.loadingReasons=!0,this.apiService.getHoldReasons().subscribe({next:e=>{this.holdReasons=e,this.loadingReasons=!1},error:()=>{this.holdReasons=[],this.loadingReasons=!1}})}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.saving=!0,this.error="";let e={entityType:this.form.value.entityType,entityId:+this.form.value.entityId,reason:this.form.value.reason,comments:this.form.value.comments||void 0};this.apiService.applyHold(e).subscribe({next:()=>{this.saving=!1,this.router.navigate(["/holds"])},error:a=>{this.saving=!1,this.error=a.error?.message||"Failed to apply hold"}})}cancel(){this.router.navigate(["/holds"])}hasError(e){let a=this.form.get(e);return!!(a&&a.invalid&&a.touched)}getEntityTypeLabel(e){return{ORDER:"Order",OPERATION:"Operation",BATCH:"Batch",INVENTORY:"Inventory",EQUIPMENT:"Equipment"}[e]||e}static{this.\u0275fac=function(a){return new(a||i)(v(U),v(I),v(V))}}static{this.\u0275cmp=S({type:i,selectors:[["app-hold-form"]],decls:47,vars:17,consts:[[1,"hold-form-page"],[1,"page-header"],[1,"page-title"],["class","error-message",4,"ngIf"],[1,"form-card",3,"ngSubmit","formGroup"],[1,"form-group"],["for","entityType"],[1,"required"],["id","entityType","formControlName","entityType"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","field-error",4,"ngIf"],["for","entityId"],["type","number","id","entityId","formControlName","entityId","placeholder","Enter entity ID","min","1"],["for","reason"],["id","reason","formControlName","reason"],["class","loading-hint",4,"ngIf"],["for","comments"],["id","comments","formControlName","comments","placeholder","Optional comments...","rows","3"],[1,"hold-warning"],[1,"fa","fa-exclamation-triangle"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-danger",3,"disabled"],[4,"ngIf"],[1,"error-message"],[3,"value"],[1,"field-error"],[1,"loading-hint"],[1,"fa","fa-ban"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),o(3,"Apply Hold"),t()(),m(4,Ve,2,1,"div",3),n(5,"form",4),g("ngSubmit",function(){return l.onSubmit()}),n(6,"div",5)(7,"label",6),o(8,"Entity Type "),n(9,"span",7),o(10,"*"),t()(),n(11,"select",8)(12,"option",9),o(13,"-- Select Entity Type --"),t(),m(14,Ae,2,2,"option",10),t(),m(15,Le,2,0,"span",11),t(),n(16,"div",5)(17,"label",12),o(18,"Entity ID "),n(19,"span",7),o(20,"*"),t()(),x(21,"input",13),m(22,De,2,0,"span",11),t(),n(23,"div",5)(24,"label",14),o(25,"Hold Reason "),n(26,"span",7),o(27,"*"),t()(),n(28,"select",15)(29,"option",9),o(30,"-- Select Reason --"),t(),m(31,Fe,2,3,"option",10),t(),m(32,ze,2,0,"span",16)(33,Be,2,0,"span",11),t(),n(34,"div",5)(35,"label",17),o(36,"Comments"),t(),x(37,"textarea",18),t(),n(38,"div",19),x(39,"i",20),o(40," Applying a hold will block the selected entity from being used in production operations until released. "),t(),n(41,"div",21)(42,"button",22),g("click",function(){return l.cancel()}),o(43,"Cancel"),t(),n(44,"button",23),m(45,$e,2,0,"span",24)(46,qe,3,0,"span",24),t()()()()),a&2&&(r(4),s("ngIf",l.error),r(),s("formGroup",l.form),r(6),y("invalid",l.hasError("entityType")),r(3),s("ngForOf",l.entityTypes),r(),s("ngIf",l.hasError("entityType")),r(6),y("invalid",l.hasError("entityId")),r(),s("ngIf",l.hasError("entityId")),r(6),y("invalid",l.hasError("reason")),r(3),s("ngForOf",l.holdReasons),r(),s("ngIf",l.loadingReasons),r(),s("ngIf",l.hasError("reason")),r(11),s("disabled",l.saving||l.form.invalid),r(),s("ngIf",l.saving),r(),s("ngIf",!l.saving))},dependencies:[N,O,F,q,j,A,ne,$,L,D,ie,z,B],styles:[".hold-form-page[_ngcontent-%COMP%]{padding:24px;max-width:600px}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1a1a2e;margin:0}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:24px;box-shadow:0 1px 3px #0000001a}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:6px;color:#333;font-size:.9rem}.required[_ngcontent-%COMP%]{color:#dc3545}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ddd;border-radius:6px;font-size:.9rem;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#4a90d9;box-shadow:0 0 0 2px #4a90d933}.form-group[_ngcontent-%COMP%]   input.invalid[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select.invalid[_ngcontent-%COMP%]{border-color:#dc3545}.field-error[_ngcontent-%COMP%]{color:#dc3545;font-size:.8rem;margin-top:4px;display:block}.loading-hint[_ngcontent-%COMP%]{color:#6c757d;font-size:.8rem;font-style:italic}.hold-warning[_ngcontent-%COMP%]{background:#fff3cd;border:1px solid #ffc107;border-radius:6px;padding:12px 16px;margin:20px 0;color:#856404;font-size:.9rem}.hold-warning[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:8px;color:#e67e00}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:24px}.btn[_ngcontent-%COMP%]{padding:8px 20px;border:none;border-radius:6px;cursor:pointer;font-size:.9rem;font-weight:500}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:12px 16px;border-radius:6px;margin-bottom:16px}"]})}}return i})();function je(i,p){if(i&1){let e=C();n(0,"div",10)(1,"button",11),g("click",function(){f(e);let l=d();return u(l.releaseHold())}),x(2,"i",12),o(3),t()()}if(i&2){let e=d();r(),s("disabled",e.releasing),r(2),_(" ",e.releasing?"Releasing...":"Release Hold"," ")}}function Ue(i,p){i&1&&(n(0,"div",13),x(1,"app-loading-spinner",14),t())}function Ge(i,p){if(i&1&&(n(0,"div",15),o(1),t()),i&2){let e=d();r(),_(" ",e.error," ")}}function Ye(i,p){if(i&1&&(n(0,"div",24)(1,"span",25),o(2,"Entity Name"),t(),n(3,"span",26),o(4),t()()),i&2){let e=d(2);r(4),h(e.hold.entityName)}}function Qe(i,p){if(i&1&&(n(0,"div",24)(1,"span",25),o(2,"Duration"),t(),n(3,"span",26),o(4),t()()),i&2){let e=d(2);r(4),h(e.formatDuration(e.hold.durationMinutes))}}function We(i,p){if(i&1&&(n(0,"div",32)(1,"span",33),o(2,"Comments:"),t(),o(3),t()),i&2){let e=d(2);r(3),_(" ",e.hold.comments," ")}}function Ze(i,p){if(i&1&&(n(0,"div",35)(1,"span",33),o(2,"Release Comments:"),t(),o(3),t()),i&2){let e=d(3);r(3),_(" ",e.hold.releaseComments," ")}}function Je(i,p){if(i&1&&(n(0,"div",23)(1,"h3"),o(2,"Release Information"),t(),n(3,"div",24)(4,"span",25),o(5,"Released By"),t(),n(6,"span",26),o(7),t()(),n(8,"div",24)(9,"span",25),o(10,"Released On"),t(),n(11,"span",26),o(12),M(13,"date"),t()(),m(14,Ze,4,1,"div",34),t()),i&2){let e=d(2);r(7),h(e.hold.releasedBy),r(5),h(H(13,3,e.hold.releasedOn,"medium")),r(2),s("ngIf",e.hold.releaseComments)}}function Ke(i,p){if(i&1){let e=C();n(0,"div",16)(1,"div",17)(2,"div",18)(3,"div",19)(4,"h2"),o(5),t(),n(6,"span",20),o(7),t()(),n(8,"span",21),o(9),t()(),n(10,"div",22)(11,"div",23)(12,"h3"),o(13,"Hold Information"),t(),n(14,"div",24)(15,"span",25),o(16,"Hold ID"),t(),n(17,"span",26),o(18),t()(),n(19,"div",24)(20,"span",25),o(21,"Entity Type"),t(),n(22,"span",26),o(23),t()(),n(24,"div",24)(25,"span",25),o(26,"Entity ID"),t(),n(27,"span",27),g("click",function(){f(e);let l=d();return u(l.navigateToEntity())}),o(28),t()(),m(29,Ye,5,1,"div",28)(30,Qe,5,1,"div",28),t(),n(31,"div",23)(32,"h3"),o(33,"Reason"),t(),n(34,"div",29),o(35),t(),m(36,We,4,1,"div",30),t(),n(37,"div",23)(38,"h3"),o(39,"Applied By"),t(),n(40,"div",24)(41,"span",25),o(42,"Applied By"),t(),n(43,"span",26),o(44),t()(),n(45,"div",24)(46,"span",25),o(47,"Applied On"),t(),n(48,"span",26),o(49),M(50,"date"),t()()(),m(51,Je,15,6,"div",31),t()()()}if(i&2){let e=d();r(5),_("Hold #",e.hold.holdId,""),r(),s("ngClass",e.getEntityTypeClass(e.hold.entityType)),r(),_(" ",e.getEntityTypeLabel(e.hold.entityType)," "),r(),s("ngClass",e.getStatusClass(e.hold.status)),r(),_(" ",e.hold.status," "),r(9),h(e.hold.holdId),r(5),h(e.getEntityTypeLabel(e.hold.entityType)),r(5),h(e.hold.entityId),r(),s("ngIf",e.hold.entityName),r(),s("ngIf",e.hold.durationMinutes),r(5),_(" ",e.hold.reason," "),r(),s("ngIf",e.hold.comments),r(8),h(e.hold.appliedBy),r(5),h(H(50,15,e.hold.appliedOn,"medium")),r(2),s("ngIf",e.hold.status==="RELEASED")}}var ge=(()=>{class i{constructor(e,a,l){this.route=e,this.router=a,this.apiService=l,this.hold=null,this.loading=!0,this.error=null,this.releasing=!1,this.entityTypeLabels={ORDER:"Order",OPERATION:"Operation",BATCH:"Batch",INVENTORY:"Inventory",EQUIPMENT:"Equipment"}}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e?this.loadHold(+e):(this.error="No hold ID provided",this.loading=!1)}loadHold(e){this.loading=!0,this.error=null,this.apiService.getHoldById(e).subscribe({next:a=>{this.hold=a,this.loading=!1},error:a=>{console.error("Error loading hold:",a),this.error="Failed to load hold",this.loading=!1}})}goBack(){this.router.navigate(["/holds"])}getStatusClass(e){switch(e?.toUpperCase()){case"ACTIVE":return"status-active";case"RELEASED":return"status-released";default:return""}}getEntityTypeLabel(e){return this.entityTypeLabels[e]||e}getEntityTypeClass(e){switch(e?.toUpperCase()){case"ORDER":return"entity-order";case"OPERATION":return"entity-operation";case"BATCH":return"entity-batch";case"INVENTORY":return"entity-inventory";case"EQUIPMENT":return"entity-equipment";default:return""}}navigateToEntity(){if(this.hold)switch(this.hold.entityType){case"ORDER":this.router.navigate(["/orders",this.hold.entityId]);break;case"BATCH":this.router.navigate(["/batches",this.hold.entityId]);break;case"INVENTORY":this.router.navigate(["/inventory",this.hold.entityId]);break;case"EQUIPMENT":this.router.navigate(["/equipment",this.hold.entityId]);break}}releaseHold(){if(!this.hold||this.hold.status!=="ACTIVE")return;let e=prompt("Enter release comments (optional):");this.releasing=!0,this.apiService.releaseHold(this.hold.holdId,e||void 0).subscribe({next:()=>{this.releasing=!1,this.loadHold(this.hold.holdId)},error:a=>{this.releasing=!1,console.error("Error releasing hold:",a),this.error="Failed to release hold"}})}formatDuration(e){if(!e)return"-";if(e<60)return`${e} min`;let a=Math.floor(e/60),l=e%60;if(a<24)return`${a}h ${l}m`;let c=Math.floor(a/24),E=a%24;return`${c}d ${E}h`}static{this.\u0275fac=function(a){return new(a||i)(v(X),v(V),v(I))}}static{this.\u0275cmp=S({type:i,selectors:[["app-hold-detail"]],decls:12,vars:4,consts:[[1,"detail-container"],[1,"page-header"],[1,"header-left"],[1,"btn","btn-back",3,"click"],[1,"fas","fa-arrow-left"],[1,"page-title"],["class","header-actions",4,"ngIf"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],["class","detail-content",4,"ngIf"],[1,"header-actions"],[1,"btn","btn-success",3,"click","disabled"],[1,"fas","fa-unlock"],[1,"loading"],["message","Loading hold..."],[1,"error-message"],[1,"detail-content"],[1,"detail-card"],[1,"card-header"],[1,"header-title"],[1,"entity-badge",3,"ngClass"],[1,"status-badge",3,"ngClass"],[1,"detail-grid"],[1,"detail-section"],[1,"detail-row"],[1,"label"],[1,"value"],[1,"value","link",3,"click"],["class","detail-row",4,"ngIf"],[1,"reason-box"],["class","comments-box",4,"ngIf"],["class","detail-section",4,"ngIf"],[1,"comments-box"],[1,"comments-label"],["class","release-comments",4,"ngIf"],[1,"release-comments"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),g("click",function(){return l.goBack()}),x(4,"i",4),o(5," Back "),t(),n(6,"h1",5),o(7,"Hold Details"),t()(),m(8,je,4,2,"div",6),t(),m(9,Ue,2,0,"div",7)(10,Ge,2,1,"div",8)(11,Ke,52,18,"div",9),t()),a&2&&(r(8),s("ngIf",l.hold&&l.hold.status==="ACTIVE"),r(),s("ngIf",l.loading),r(),s("ngIf",l.error),r(),s("ngIf",!l.loading&&l.hold))},dependencies:[k,O,G,R],styles:[".detail-container[_ngcontent-%COMP%]{padding:24px}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:600;color:#1e293b}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:48px}.error-message[_ngcontent-%COMP%]{background:#fef2f2;border:1px solid #fecaca;color:#dc2626;padding:12px 16px;border-radius:8px;margin-bottom:16px}.detail-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.detail-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:8px;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;background:#f8fafc;border-bottom:1px solid #e2e8f0}.header-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#1e293b}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;padding:24px}.detail-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:14px;font-weight:600;color:#64748b;text-transform:uppercase;letter-spacing:.05em}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.label[_ngcontent-%COMP%]{color:#64748b;font-size:14px}.value[_ngcontent-%COMP%]{color:#1e293b;font-weight:500;font-size:14px}.value.link[_ngcontent-%COMP%]{color:#3b82f6;cursor:pointer}.value.link[_ngcontent-%COMP%]:hover{text-decoration:underline}.reason-box[_ngcontent-%COMP%]{padding:16px;background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;color:#92400e;font-size:14px;line-height:1.6}.comments-box[_ngcontent-%COMP%], .release-comments[_ngcontent-%COMP%]{padding:12px;background:#f8fafc;border-radius:6px;font-size:14px;color:#475569;margin-top:8px}.comments-label[_ngcontent-%COMP%]{font-weight:600;color:#64748b;display:block;margin-bottom:4px}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 12px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.status-active[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.status-released[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.entity-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;border-radius:6px;font-size:12px;font-weight:500}.entity-order[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.entity-operation[_ngcontent-%COMP%]{background:#f3e8ff;color:#7c3aed}.entity-batch[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.entity-inventory[_ngcontent-%COMP%]{background:#fef3c7;color:#b45309}.entity-equipment[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-back[_ngcontent-%COMP%]{background:transparent;color:#64748b;padding:8px 12px}.btn-back[_ngcontent-%COMP%]:hover{background:#f1f5f9;color:#1e293b}.btn-success[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#bbf7d0}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.detail-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return i})();var Xe=[{path:"",component:ce},{path:"new",component:me},{path:":id",component:ge}],fe=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=T({type:i})}static{this.\u0275inj=P({imports:[Q.forChild(Xe),Q]})}}return i})();var Et=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=T({type:i})}static{this.\u0275inj=P({imports:[K,oe,fe,le]})}}return i})();export{Et as HoldsModule};

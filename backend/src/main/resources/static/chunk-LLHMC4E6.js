import{h as B,n as Y}from"./chunk-LMWWBC6Z.js";import{$a as L,Aa as T,B as l,Ba as V,C as S,Da as z,F as r,Fa as j,G as o,H as c,Ha as q,Ia as C,Ja as F,Ka as G,L as O,M as P,Ma as A,N as m,Pa as R,Sa as U,T as d,U as b,V as k,Za as D,ia as E,ka as I,m as v,o as y,p as M,qa as N,r as h,s as _,w as i,x,z as g}from"./chunk-SXRLIX2W.js";function $(t,p){t&1&&(r(0,"div",8)(1,"div",9),c(2,"i",10),o(),r(3,"h3"),d(4,"Password Changed Successfully"),o(),r(5,"p"),d(6,"Your password has been updated. Redirecting to profile..."),o()())}function H(t,p){if(t&1&&(r(0,"div",30),c(1,"i",31),r(2,"span"),d(3),o()()),t&2){let e=m(2);i(3),b(e.currentUser.email)}}function J(t,p){t&1&&(r(0,"div",32),d(1," Current password is required "),o())}function K(t,p){if(t&1&&(r(0,"div",33)(1,"div",34),c(2,"div",35),o(),r(3,"span",36),d(4),o()()),t&2){let e=m(2);i(2),S("width",e.getPasswordStrength().percent,"%"),l("ngClass",e.getPasswordStrength().class),i(),l("ngClass",e.getPasswordStrength().class),i(),b(e.getPasswordStrength().label)}}function Q(t,p){t&1&&(r(0,"div",32),d(1," New password is required "),o())}function X(t,p){t&1&&(r(0,"div",32),d(1," Password must be at least 6 characters "),o())}function ee(t,p){t&1&&(r(0,"div",32),d(1," Please confirm your new password "),o())}function te(t,p){t&1&&(r(0,"div",32),d(1," Passwords do not match "),o())}function ne(t,p){if(t&1&&(r(0,"div",37),c(1,"i",38),d(2),o()),t&2){let e=m(2);i(2),k(" ",e.error," ")}}function re(t,p){t&1&&(r(0,"span"),d(1,"Change Password"),o())}function oe(t,p){t&1&&(r(0,"span"),c(1,"i",39),d(2," Changing..."),o())}function ie(t,p){if(t&1){let e=O();r(0,"form",11),P("ngSubmit",function(){h(e);let s=m();return _(s.onSubmit())}),g(1,H,4,1,"div",12),r(2,"div",13)(3,"label",14),d(4,"Current Password"),o(),r(5,"div",15),c(6,"input",16),r(7,"button",17),P("click",function(){h(e);let s=m();return _(s.togglePasswordVisibility("current"))}),c(8,"i",18),o()(),g(9,J,2,0,"div",19),o(),r(10,"div",13)(11,"label",20),d(12,"New Password"),o(),r(13,"div",15),c(14,"input",21),r(15,"button",17),P("click",function(){h(e);let s=m();return _(s.togglePasswordVisibility("new"))}),c(16,"i",18),o()(),g(17,K,5,5,"div",22)(18,Q,2,0,"div",19)(19,X,2,0,"div",19),o(),r(20,"div",13)(21,"label",23),d(22,"Confirm New Password"),o(),r(23,"div",15),c(24,"input",24),r(25,"button",17),P("click",function(){h(e);let s=m();return _(s.togglePasswordVisibility("confirm"))}),c(26,"i",18),o()(),g(27,ee,2,0,"div",19)(28,te,2,0,"div",19),o(),g(29,ne,3,1,"div",25),r(30,"div",26)(31,"button",27),d(32,"Cancel"),o(),r(33,"button",28),g(34,re,2,0,"span",29)(35,oe,3,0,"span",29),o()()()}if(t&2){let e,n,s,f,u,w,a=m();l("formGroup",a.form),i(),l("ngIf",a.currentUser),i(5),l("type",a.showCurrentPassword?"text":"password"),i(2),l("ngClass",a.showCurrentPassword?"fa-eye-slash":"fa-eye"),i(),l("ngIf",((e=a.form.get("currentPassword"))==null?null:e.touched)&&((e=a.form.get("currentPassword"))==null||e.errors==null?null:e.errors.required)),i(5),l("type",a.showNewPassword?"text":"password"),i(2),l("ngClass",a.showNewPassword?"fa-eye-slash":"fa-eye"),i(),l("ngIf",(n=a.form.get("newPassword"))==null?null:n.value),i(),l("ngIf",((s=a.form.get("newPassword"))==null?null:s.touched)&&((s=a.form.get("newPassword"))==null||s.errors==null?null:s.errors.required)),i(),l("ngIf",((f=a.form.get("newPassword"))==null?null:f.touched)&&((f=a.form.get("newPassword"))==null||f.errors==null?null:f.errors.minlength)),i(5),l("type",a.showConfirmPassword?"text":"password"),i(2),l("ngClass",a.showConfirmPassword?"fa-eye-slash":"fa-eye"),i(),l("ngIf",((u=a.form.get("confirmPassword"))==null?null:u.touched)&&((u=a.form.get("confirmPassword"))==null||u.errors==null?null:u.errors.required)),i(),l("ngIf",((w=a.form.get("confirmPassword"))==null?null:w.touched)&&((w=a.form.get("confirmPassword"))==null||w.errors==null?null:w.errors.passwordMismatch)),i(),l("ngIf",a.error),i(4),l("disabled",a.form.invalid||a.loading),i(),l("ngIf",!a.loading),i(),l("ngIf",a.loading)}}var Z=(()=>{class t{constructor(e,n,s,f){this.fb=e,this.authService=n,this.apiService=s,this.router=f,this.currentUser=null,this.loading=!1,this.success=!1,this.error="",this.showCurrentPassword=!1,this.showNewPassword=!1,this.showConfirmPassword=!1,this.form=this.fb.group({currentPassword:["",[C.required]],newPassword:["",[C.required,C.minLength(6)]],confirmPassword:["",[C.required]]},{validators:this.passwordMatchValidator})}ngOnInit(){this.authService.currentUser$.subscribe(e=>{this.currentUser=e})}passwordMatchValidator(e){let n=e.get("newPassword"),s=e.get("confirmPassword");return n&&s&&n.value!==s.value?(s.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}getPasswordStrength(){let e=this.form.get("newPassword")?.value||"",n=0;return e.length>=6&&(n+=20),e.length>=8&&(n+=20),/[A-Z]/.test(e)&&(n+=20),/[a-z]/.test(e)&&(n+=10),/[0-9]/.test(e)&&(n+=15),/[^A-Za-z0-9]/.test(e)&&(n+=15),n<=30?{label:"Weak",class:"weak",percent:n}:n<=60?{label:"Fair",class:"fair",percent:n}:n<=80?{label:"Good",class:"good",percent:n}:{label:"Strong",class:"strong",percent:n}}togglePasswordVisibility(e){e==="current"&&(this.showCurrentPassword=!this.showCurrentPassword),e==="new"&&(this.showNewPassword=!this.showNewPassword),e==="confirm"&&(this.showConfirmPassword=!this.showConfirmPassword)}onSubmit(){if(this.form.invalid)return;this.loading=!0,this.error="";let{currentPassword:e,newPassword:n}=this.form.value;this.apiService.changePassword({currentPassword:e,newPassword:n}).subscribe({next:()=>{this.loading=!1,this.success=!0,setTimeout(()=>{this.router.navigate(["/profile"])},2e3)},error:s=>{this.loading=!1,this.error=s.error?.message||"Failed to change password. Please try again."}})}static{this.\u0275fac=function(n){return new(n||t)(x(D),x(j),x(B),x(T))}}static{this.\u0275cmp=y({type:t,selectors:[["app-change-password"]],decls:10,vars:2,consts:[[1,"change-password-page"],[1,"page-header"],["routerLink","/profile",1,"back-link"],[1,"fas","fa-arrow-left"],[1,"page-title"],[1,"form-card"],["class","success-message",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"success-message"],[1,"success-icon"],[1,"fas","fa-check-circle"],[3,"ngSubmit","formGroup"],["class","user-info",4,"ngIf"],[1,"form-group"],["for","currentPassword"],[1,"password-input"],["id","currentPassword","formControlName","currentPassword","placeholder","Enter your current password",1,"form-control",3,"type"],["type","button",1,"toggle-password",3,"click"],[1,"fas",3,"ngClass"],["class","error-message",4,"ngIf"],["for","newPassword"],["id","newPassword","formControlName","newPassword","placeholder","Enter your new password",1,"form-control",3,"type"],["class","password-strength",4,"ngIf"],["for","confirmPassword"],["id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm your new password",1,"form-control",3,"type"],["class","error-alert",4,"ngIf"],[1,"form-actions"],["type","button","routerLink","/profile",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"],[4,"ngIf"],[1,"user-info"],[1,"fas","fa-user-circle"],[1,"error-message"],[1,"password-strength"],[1,"strength-bar"],[1,"strength-fill",3,"ngClass"],[1,"strength-label",3,"ngClass"],[1,"error-alert"],[1,"fas","fa-exclamation-circle"],[1,"fas","fa-spinner","fa-spin"]],template:function(n,s){n&1&&(r(0,"div",0)(1,"div",1)(2,"a",2),c(3,"i",3),d(4," Back to Profile "),o(),r(5,"h1",4),d(6,"Change Password"),o()(),r(7,"div",5),g(8,$,7,0,"div",6)(9,ie,36,18,"form",7),o()()),n&2&&(i(8),l("ngIf",s.success),i(),l("ngIf",!s.success))},dependencies:[E,I,A,q,F,G,R,U,V],styles:[".change-password-page[_ngcontent-%COMP%]{padding:24px;max-width:500px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.back-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;color:#1976d2;text-decoration:none;font-size:14px;margin-bottom:12px}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.page-title[_ngcontent-%COMP%]{font-size:28px;font-weight:600;color:#1a1a1a;margin:0}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 12px #00000014;padding:32px}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:16px;background:#f5f5f5;border-radius:8px;margin-bottom:24px;color:#666}.user-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px;color:#1976d2}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#333;margin-bottom:8px}.password-input[_ngcontent-%COMP%]{position:relative}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px 44px 12px 14px;border:1px solid #ddd;border-radius:8px;font-size:14px;transition:border-color .2s,box-shadow .2s;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2;box-shadow:0 0 0 3px #1976d21a}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;color:#666;cursor:pointer;padding:4px}.toggle-password[_ngcontent-%COMP%]:hover{color:#1976d2}.password-strength[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-top:8px}.strength-bar[_ngcontent-%COMP%]{flex:1;height:4px;background:#eee;border-radius:2px;overflow:hidden}.strength-fill[_ngcontent-%COMP%]{height:100%;transition:width .3s,background-color .3s}.strength-fill.weak[_ngcontent-%COMP%]{background:#f44336}.strength-fill.fair[_ngcontent-%COMP%]{background:#ff9800}.strength-fill.good[_ngcontent-%COMP%]{background:#4caf50}.strength-fill.strong[_ngcontent-%COMP%]{background:#388e3c}.strength-label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;min-width:50px}.strength-label.weak[_ngcontent-%COMP%]{color:#f44336}.strength-label.fair[_ngcontent-%COMP%]{color:#ff9800}.strength-label.good[_ngcontent-%COMP%]{color:#4caf50}.strength-label.strong[_ngcontent-%COMP%]{color:#388e3c}.error-message[_ngcontent-%COMP%]{color:#d32f2f;font-size:12px;margin-top:4px}.error-alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#ffebee;color:#d32f2f;border-radius:8px;font-size:14px;margin-bottom:20px}.success-message[_ngcontent-%COMP%]{text-align:center;padding:40px 20px}.success-icon[_ngcontent-%COMP%]{font-size:64px;color:#4caf50;margin-bottom:16px}.success-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;color:#333}.success-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;margin-top:24px}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 24px;border-radius:8px;font-size:14px;font-weight:500;text-decoration:none;cursor:pointer;transition:all .2s;border:none;min-width:120px}.btn-primary[_ngcontent-%COMP%]{background:#1976d2;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#1565c0}.btn-primary[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#f5f5f5;color:#333}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}"]})}}return t})();var se=[{path:"",component:Z}],xe=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=M({type:t})}static{this.\u0275inj=v({imports:[N,L,Y,z.forChild(se)]})}}return t})();export{xe as ChangePasswordModule};

import{h as P,i as K,j as se,k as de,n as pe}from"./chunk-LMWWBC6Z.js";import{$ as H,$a as ce,Aa as M,B as c,D as C,Da as Y,E as te,F as n,G as t,H as p,Ha as w,Ia as h,Ja as T,Ka as A,L as y,La as re,M as v,Ma as z,N as s,Na as q,Pa as j,Sa as G,T as i,Ta as U,U as g,Ua as N,V as x,Va as F,W as I,Xa as ae,Z as Q,Za as W,_ as $,_a as le,da as D,fa as B,ia as ne,ja as O,ka as S,m as V,o as E,oa as ie,p as L,qa as oe,r as m,s as u,w as r,x as b,ya as k,z as f}from"./chunk-SXRLIX2W.js";function he(o,d){o&1&&(n(0,"div",10),p(1,"app-loading-spinner",11),t())}function be(o,d){if(o&1&&(n(0,"div",43),i(1),t()),o&2){let e=s().$implicit;r(),x(" ",e.blockReason," ")}}function Ce(o,d){if(o&1&&(n(0,"div",43),i(1),t()),o&2){let e=s().$implicit;r(),x(" ",e.scrapReason," ")}}function Ie(o,d){if(o&1){let e=y();n(0,"button",44),v("click",function(){m(e);let l=s().$implicit,_=s(3);return u(_.editInventory(l))}),i(1," Edit "),t()}}function Ee(o,d){if(o&1){let e=y();n(0,"button",45),v("click",function(){m(e);let l=s().$implicit,_=s(3);return u(_.openBlockModal(l))}),i(1," Block "),t()}}function Se(o,d){if(o&1){let e=y();n(0,"button",46),v("click",function(){m(e);let l=s().$implicit,_=s(3);return u(_.unblockInventory(l))}),i(1," Unblock "),t()}}function Me(o,d){if(o&1){let e=y();n(0,"button",47),v("click",function(){m(e);let l=s().$implicit,_=s(3);return u(_.deleteInventory(l))}),i(1," Delete "),t()}}function Pe(o,d){o&1&&(n(0,"span",48),i(1,"-"),t())}function Oe(o,d){if(o&1&&(n(0,"tr")(1,"td"),i(2),t(),n(3,"td"),i(4),t(),n(5,"td")(6,"span",34),i(7),t()(),n(8,"td"),i(9),t(),n(10,"td"),i(11),t(),n(12,"td"),p(13,"app-status-badge",35),f(14,be,2,1,"div",36)(15,Ce,2,1,"div",36),t(),n(16,"td"),i(17),t(),n(18,"td",37),f(19,Ie,2,0,"button",38)(20,Ee,2,0,"button",39)(21,Se,2,0,"button",40)(22,Me,2,0,"button",41)(23,Pe,2,0,"span",42),t()()),o&2){let e=d.$implicit,a=s(3);r(2),g(e.batchNumber),r(2),g(e.materialId),r(2),te("type-"+(e.inventoryType||"").toLowerCase()),r(),x(" ",e.inventoryType," "),r(2),g(e.quantity),r(2),g(e.unit),r(2),c("status",e.state),r(),c("ngIf",e.state==="BLOCKED"&&e.blockReason),r(),c("ngIf",e.state==="SCRAPPED"&&e.scrapReason),r(2),g(e.location||"-"),r(2),c("ngIf",a.canEdit(e)),r(),c("ngIf",a.canBlock(e)),r(),c("ngIf",a.canUnblock(e)),r(),c("ngIf",a.canDelete(e)),r(),c("ngIf",e.state==="SCRAPPED"||e.state==="CONSUMED")}}function ke(o,d){if(o&1&&(n(0,"table",32)(1,"thead")(2,"tr")(3,"th"),i(4,"Batch Number"),t(),n(5,"th"),i(6,"Material ID"),t(),n(7,"th"),i(8,"Type"),t(),n(9,"th"),i(10,"Quantity"),t(),n(11,"th"),i(12,"UoM"),t(),n(13,"th"),i(14,"State"),t(),n(15,"th"),i(16,"Location"),t(),n(17,"th"),i(18,"Actions"),t()()(),n(19,"tbody"),f(20,Oe,24,16,"tr",33),t()()),o&2){let e=s(2);r(20),c("ngForOf",e.inventory)}}function we(o,d){o&1&&(n(0,"p",49),i(1," No inventory items found matching the selected filters. "),t())}function Te(o,d){if(o&1){let e=y();n(0,"app-pagination",50),v("pageChange",function(l){m(e);let _=s(2);return u(_.onPageChange(l))})("sizeChange",function(l){m(e);let _=s(2);return u(_.onSizeChange(l))}),t()}if(o&2){let e=s(2);c("page",e.page)("size",e.size)("totalElements",e.totalElements)("totalPages",e.totalPages)("hasNext",e.hasNext)("hasPrevious",e.hasPrevious)}}function Ne(o,d){if(o&1){let e=y();n(0,"div")(1,"div",12)(2,"div",13)(3,"div",14)(4,"label"),i(5,"State:"),t(),n(6,"select",15),v("change",function(l){m(e);let _=s();return u(_.onFilterStateChange(l.target.value))}),n(7,"option",16),i(8,"All States"),t(),n(9,"option",17),i(10,"Available"),t(),n(11,"option",18),i(12,"Consumed"),t(),n(13,"option",19),i(14,"On Hold"),t(),n(15,"option",20),i(16,"Blocked"),t(),n(17,"option",21),i(18,"Scrapped"),t()()(),n(19,"div",14)(20,"label"),i(21,"Type:"),t(),n(22,"select",15),v("change",function(l){m(e);let _=s();return u(_.onFilterTypeChange(l.target.value))}),n(23,"option",16),i(24,"All Types"),t(),n(25,"option",22),i(26,"Raw Material (RM)"),t(),n(27,"option",23),i(28,"Intermediate (IM)"),t(),n(29,"option",24),i(30,"Finished Goods (FG)"),t(),n(31,"option",25),i(32,"Work in Progress (WIP)"),t()()(),n(33,"div",26)(34,"label"),i(35,"Search:"),t(),n(36,"input",27),v("input",function(l){m(e);let _=s();return u(_.onSearchChange(l.target.value))}),t()()()(),n(37,"div",28),f(38,ke,21,1,"table",29)(39,we,2,0,"p",30)(40,Te,1,6,"app-pagination",31),t()()}if(o&2){let e=s();r(3),C("filter-active",e.filterState),r(3),C("filter-active",e.filterState),c("value",e.filterState||"all"),r(13),C("filter-active",e.filterType),r(3),C("filter-active",e.filterType),c("value",e.filterType||"all"),r(14),c("value",e.searchTerm),r(2),c("ngIf",e.inventory.length>0),r(),c("ngIf",e.inventory.length===0),r(),c("ngIf",e.inventory.length>0)}}function Fe(o,d){if(o&1&&(n(0,"div",64),i(1),t()),o&2){let e=s(2);r(),g(e.actionError)}}function Re(o,d){if(o&1){let e=y();n(0,"div",51),v("click",function(){m(e);let l=s();return u(l.closeBlockModal())}),n(1,"div",52),v("click",function(l){return m(e),u(l.stopPropagation())}),n(2,"div",53)(3,"h3"),i(4,"Block Inventory"),t(),n(5,"button",54),v("click",function(){m(e);let l=s();return u(l.closeBlockModal())}),p(6,"i",55),t()(),n(7,"div",56)(8,"p"),i(9,"You are about to block inventory:"),t(),n(10,"p")(11,"strong"),i(12,"Batch:"),t(),i(13),t(),n(14,"p")(15,"strong"),i(16,"Material:"),t(),i(17),t(),n(18,"p")(19,"strong"),i(20,"Quantity:"),t(),i(21),t(),n(22,"div",57)(23,"label",58),i(24,"Reason for Blocking *"),t(),n(25,"textarea",59),H("ngModelChange",function(l){m(e);let _=s();return $(_.actionReason,l)||(_.actionReason=l),u(l)}),t()(),f(26,Fe,2,1,"div",60),t(),n(27,"div",61)(28,"button",62),v("click",function(){m(e);let l=s();return u(l.closeBlockModal())}),i(29,"Cancel"),t(),n(30,"button",63),v("click",function(){m(e);let l=s();return u(l.confirmBlock())}),i(31),t()()()()}if(o&2){let e=s();r(13),x(" ",e.selectedInventory==null?null:e.selectedInventory.batchNumber,""),r(4),x(" ",e.selectedInventory==null?null:e.selectedInventory.materialId,""),r(4),I(" ",e.selectedInventory==null?null:e.selectedInventory.quantity," ",e.selectedInventory==null?null:e.selectedInventory.unit,""),r(4),Q("ngModel",e.actionReason),r(),c("ngIf",e.actionError),r(2),c("disabled",e.actionLoading),r(2),c("disabled",e.actionLoading),r(),x(" ",e.actionLoading?"Blocking...":"Confirm Block"," ")}}function Ve(o,d){if(o&1&&(n(0,"div",64),i(1),t()),o&2){let e=s(2);r(),g(e.actionError)}}function Le(o,d){if(o&1){let e=y();n(0,"div",51),v("click",function(){m(e);let l=s();return u(l.closeScrapModal())}),n(1,"div",52),v("click",function(l){return m(e),u(l.stopPropagation())}),n(2,"div",53)(3,"h3"),i(4,"Scrap Inventory"),t(),n(5,"button",54),v("click",function(){m(e);let l=s();return u(l.closeScrapModal())}),p(6,"i",55),t()(),n(7,"div",56)(8,"p",65),i(9,"Warning: Scrapping inventory is permanent and cannot be undone."),t(),n(10,"p")(11,"strong"),i(12,"Batch:"),t(),i(13),t(),n(14,"p")(15,"strong"),i(16,"Material:"),t(),i(17),t(),n(18,"p")(19,"strong"),i(20,"Quantity:"),t(),i(21),t(),n(22,"div",57)(23,"label",66),i(24,"Reason for Scrapping *"),t(),n(25,"textarea",67),H("ngModelChange",function(l){m(e);let _=s();return $(_.actionReason,l)||(_.actionReason=l),u(l)}),t()(),f(26,Ve,2,1,"div",60),t(),n(27,"div",61)(28,"button",62),v("click",function(){m(e);let l=s();return u(l.closeScrapModal())}),i(29,"Cancel"),t(),n(30,"button",68),v("click",function(){m(e);let l=s();return u(l.confirmScrap())}),i(31),t()()()()}if(o&2){let e=s();r(13),x(" ",e.selectedInventory==null?null:e.selectedInventory.batchNumber,""),r(4),x(" ",e.selectedInventory==null?null:e.selectedInventory.materialId,""),r(4),I(" ",e.selectedInventory==null?null:e.selectedInventory.quantity," ",e.selectedInventory==null?null:e.selectedInventory.unit,""),r(4),Q("ngModel",e.actionReason),r(),c("ngIf",e.actionError),r(2),c("disabled",e.actionLoading),r(2),c("disabled",e.actionLoading),r(),x(" ",e.actionLoading?"Scrapping...":"Confirm Scrap"," ")}}var ue=(()=>{class o{constructor(e,a,l){this.apiService=e,this.router=a,this.route=l,this.inventory=[],this.loading=!0,this.page=0,this.size=20,this.totalElements=0,this.totalPages=0,this.hasNext=!1,this.hasPrevious=!1,this.filterState="",this.filterType="",this.searchTerm="",this.showBlockModal=!1,this.showScrapModal=!1,this.selectedInventory=null,this.actionReason="",this.actionLoading=!1,this.actionError=""}ngOnInit(){this.route.queryParams.subscribe(e=>{e.state&&(this.filterState=e.state),e.type&&(this.filterType=e.type),this.loadInventory()})}loadInventory(){this.loading=!0;let e={page:this.page,size:this.size,sortBy:"createdOn",sortDirection:"DESC",status:this.filterState||void 0,type:this.filterType||void 0,search:this.searchTerm||void 0};this.apiService.getInventoryPaged(e).subscribe({next:a=>{this.inventory=a.content,this.page=a.page,this.size=a.size,this.totalElements=a.totalElements,this.totalPages=a.totalPages,this.hasNext=a.hasNext,this.hasPrevious=a.hasPrevious,this.loading=!1},error:a=>{console.error("Error loading inventory:",a),this.loading=!1}})}onPageChange(e){this.page=e,this.loadInventory()}onSizeChange(e){this.size=e,this.page=0,this.loadInventory()}onFilterStateChange(e){this.filterState=e==="all"?"":e,this.page=0,this.loadInventory()}onFilterTypeChange(e){this.filterType=e==="all"?"":e,this.page=0,this.loadInventory()}onSearchChange(e){this.searchTerm=e,this.page=0,this.loadInventory()}openBlockModal(e){this.selectedInventory=e,this.actionReason="",this.actionError="",this.showBlockModal=!0}closeBlockModal(){this.showBlockModal=!1,this.selectedInventory=null,this.actionReason="",this.actionError=""}confirmBlock(){if(!this.actionReason.trim()){this.actionError="Please provide a reason for blocking.";return}this.selectedInventory&&(this.actionLoading=!0,this.actionError="",this.apiService.blockInventory(this.selectedInventory.inventoryId,this.actionReason).subscribe({next:()=>{this.actionLoading=!1,this.closeBlockModal(),this.loadInventory()},error:e=>{this.actionLoading=!1,this.actionError=e.error?.message||"Failed to block inventory."}}))}unblockInventory(e){confirm(`Are you sure you want to unblock inventory ${e.batchNumber}?`)&&(this.loading=!0,this.apiService.unblockInventory(e.inventoryId).subscribe({next:()=>{this.loadInventory()},error:a=>{this.loading=!1,alert(a.error?.message||"Failed to unblock inventory.")}}))}openScrapModal(e){this.selectedInventory=e,this.actionReason="",this.actionError="",this.showScrapModal=!0}closeScrapModal(){this.showScrapModal=!1,this.selectedInventory=null,this.actionReason="",this.actionError=""}confirmScrap(){if(!this.actionReason.trim()){this.actionError="Please provide a reason for scrapping.";return}this.selectedInventory&&(this.actionLoading=!0,this.actionError="",this.apiService.scrapInventory(this.selectedInventory.inventoryId,this.actionReason).subscribe({next:()=>{this.actionLoading=!1,this.closeScrapModal(),this.loadInventory()},error:e=>{this.actionLoading=!1,this.actionError=e.error?.message||"Failed to scrap inventory."}}))}receiveMaterial(){this.router.navigate(["/inventory/receive"])}createInventory(){this.router.navigate(["/inventory/new"])}editInventory(e){this.router.navigate(["/inventory",e.inventoryId,"edit"])}deleteInventory(e){confirm(`Are you sure you want to delete inventory for ${e.materialId}?`)&&(this.loading=!0,this.apiService.deleteInventory(e.inventoryId).subscribe({next:()=>{this.loadInventory()},error:a=>{this.loading=!1,alert(a.error?.message||"Failed to delete inventory.")}}))}canBlock(e){return e.state!=="BLOCKED"&&e.state!=="CONSUMED"&&e.state!=="SCRAPPED"}canUnblock(e){return e.state==="BLOCKED"}canScrap(e){return e.state!=="CONSUMED"&&e.state!=="SCRAPPED"}canEdit(e){return e.state!=="CONSUMED"&&e.state!=="SCRAPPED"}canDelete(e){return e.state!=="CONSUMED"&&e.state!=="SCRAPPED"}static{this.\u0275fac=function(a){return new(a||o)(b(P),b(M),b(k))}}static{this.\u0275cmp=E({type:o,selectors:[["app-inventory-list"]],decls:14,vars:4,consts:[[1,"container"],[1,"page-header"],[1,"page-title"],[1,"header-actions"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-download"],[1,"btn","btn-primary",3,"click"],["class","text-center",4,"ngIf"],[4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"text-center"],["message","Loading inventory..."],[1,"card"],[1,"filters"],[1,"filter-group"],[3,"change","value"],["value","all"],["value","AVAILABLE"],["value","CONSUMED"],["value","ON_HOLD"],["value","BLOCKED"],["value","SCRAPPED"],["value","RM"],["value","IM"],["value","FG"],["value","WIP"],[1,"filter-group","search-group"],["type","text","placeholder","Search by batch or material...",3,"input","value"],[1,"table-container"],["class","table",4,"ngIf"],["class","no-data",4,"ngIf"],[3,"page","size","totalElements","totalPages","hasNext","hasPrevious","pageChange","sizeChange",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],[1,"type-badge"],[3,"status"],["class","reason-text",4,"ngIf"],[1,"actions-cell"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["class","btn btn-sm btn-warning",3,"click",4,"ngIf"],["class","btn btn-sm btn-success",3,"click",4,"ngIf"],["class","btn btn-sm btn-danger",3,"click",4,"ngIf"],["class","no-actions",4,"ngIf"],[1,"reason-text"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"no-actions"],[1,"no-data"],[3,"pageChange","sizeChange","page","size","totalElements","totalPages","hasNext","hasPrevious"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"fas","fa-xmark"],[1,"modal-body"],[1,"form-group"],["for","blockReason"],["id","blockReason","placeholder","Enter reason for blocking this inventory...","rows","3",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"btn","btn-warning",3,"click","disabled"],[1,"error-message"],[1,"warning-text"],["for","scrapReason"],["id","scrapReason","placeholder","Enter reason for scrapping this inventory...","rows","3",3,"ngModelChange","ngModel"],[1,"btn","btn-danger",3,"click","disabled"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),i(3,"Inventory"),t(),n(4,"div",3)(5,"button",4),v("click",function(){return l.receiveMaterial()}),p(6,"i",5),i(7," Receive Material "),t(),n(8,"button",6),v("click",function(){return l.createInventory()}),i(9,"New Inventory"),t()()(),f(10,he,2,0,"div",7)(11,Ne,41,14,"div",8),t(),f(12,Re,32,9,"div",9)(13,Le,32,9,"div",9)),a&2&&(r(10),c("ngIf",l.loading),r(),c("ngIf",!l.loading),r(),c("ngIf",l.showBlockModal),r(),c("ngIf",l.showScrapModal))},dependencies:[O,S,N,F,w,T,re,K,se,de],styles:[".table-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;overflow:hidden}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.btn-success[_ngcontent-%COMP%]{background-color:#388e3c;color:#fff;border:none}.btn-success[_ngcontent-%COMP%]:hover{background-color:#2e7d32}.btn-success[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:6px}.summary-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px;flex-wrap:wrap}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:16px 24px;display:flex;flex-direction:column;align-items:center;min-width:120px}.summary-label[_ngcontent-%COMP%]{font-size:12px;color:#888;text-transform:uppercase}.summary-value[_ngcontent-%COMP%]{font-size:24px;font-weight:500;color:#333}.type-badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 8px;border-radius:4px;font-size:12px;font-weight:500}.type-rm[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1565c0}.type-im[_ngcontent-%COMP%]{background-color:#fff3e0;color:#e65100}.type-fg[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.type-wip[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.no-actions[_ngcontent-%COMP%]{color:#999}.reason-text[_ngcontent-%COMP%]{font-size:11px;color:#666;margin-top:4px;font-style:italic}.warning-text[_ngcontent-%COMP%]{color:#c62828;font-weight:500;background-color:#ffebee;padding:10px;border-radius:4px;margin-bottom:16px}@media (max-width: 576px){.header-actions[_ngcontent-%COMP%]{flex-wrap:wrap}.summary-card[_ngcontent-%COMP%]{min-width:100px;padding:12px 16px}.summary-value[_ngcontent-%COMP%]{font-size:20px}}"]})}}return o})();function De(o,d){o&1&&(n(0,"div",5),i(1,"Loading inventory..."),t())}function Be(o,d){if(o&1&&(n(0,"div",36),i(1),t()),o&2){let e=s(2);r(),g(e.error)}}function Ae(o,d){if(o&1&&(n(0,"span",37),i(1),t()),o&2){let e=s(2);r(),x(" ",e.getError("materialId")," ")}}function ze(o,d){if(o&1&&(n(0,"option",38),i(1),t()),o&2){let e=d.$implicit;c("value",e),r(),g(e)}}function qe(o,d){if(o&1&&(n(0,"span",37),i(1),t()),o&2){let e=s(2);r(),x(" ",e.getError("inventoryType")," ")}}function je(o,d){if(o&1&&(n(0,"option",38),i(1),t()),o&2){let e=d.$implicit;c("value",e.form_code),r(),g(e.form_name)}}function Ge(o,d){if(o&1&&(n(0,"span",42),i(1),t()),o&2){let e=s(3);r(),I(" Range: ",e.selectedFormConfig.min_storage_temp,"\xB0C - ",e.selectedFormConfig.max_storage_temp,"\xB0C ")}}function Ue(o,d){if(o&1&&(n(0,"div",11)(1,"label",39),i(2,"Temperature (\xB0C)"),t(),p(3,"input",40),f(4,Ge,2,2,"span",41),t()),o&2){let e=s(2);r(4),c("ngIf",e.selectedFormConfig.min_storage_temp)}}function We(o,d){o&1&&(n(0,"div",11)(1,"label",43),i(2,"Moisture (%)"),t(),p(3,"input",44),t())}function Ke(o,d){o&1&&(n(0,"div",11)(1,"label",45),i(2,"Density (kg/m&sup3;)"),t(),p(3,"input",46),t())}function Qe(o,d){if(o&1&&(n(0,"div",10),f(1,We,4,0,"div",25)(2,Ke,4,0,"div",25),t()),o&2){let e=s(2);r(),c("ngIf",e.selectedFormConfig==null?null:e.selectedFormConfig.tracks_moisture),r(),c("ngIf",e.selectedFormConfig==null?null:e.selectedFormConfig.tracks_density)}}function $e(o,d){if(o&1&&(n(0,"div",47),p(1,"i",48),i(2),t()),o&2){let e=s(2);r(2),x(" ",e.handlingNotes," ")}}function He(o,d){if(o&1&&(n(0,"span",37),i(1),t()),o&2){let e=s(2);r(),x(" ",e.getError("quantity")," ")}}function Ye(o,d){o&1&&(n(0,"div",9)(1,"h2"),i(2,"Status"),t(),n(3,"div",11)(4,"label",49),i(5,"State"),t(),n(6,"select",50)(7,"option",51),i(8,"Available"),t(),n(9,"option",52),i(10,"Reserved"),t(),n(11,"option",53),i(12,"Produced"),t(),n(13,"option",54),i(14,"Blocked"),t(),n(15,"option",55),i(16,"On Hold"),t()()()())}function Ze(o,d){if(o&1){let e=y();n(0,"div",6)(1,"form",7),v("ngSubmit",function(){m(e);let l=s();return u(l.onSubmit())}),f(2,Be,2,1,"div",8),n(3,"div",9)(4,"h2"),i(5,"Material Information"),t(),n(6,"div",10)(7,"div",11)(8,"label",12),i(9,"Material ID *"),t(),p(10,"input",13),f(11,Ae,2,1,"span",14),t(),n(12,"div",11)(13,"label",15),i(14,"Material Name"),t(),p(15,"input",16),t()(),n(16,"div",10)(17,"div",11)(18,"label",17),i(19,"Inventory Type *"),t(),n(20,"select",18)(21,"option",19),i(22,"Select type..."),t(),f(23,ze,2,2,"option",20),t(),f(24,qe,2,1,"span",14),t(),n(25,"div",11)(26,"label",21),i(27,"Location"),t(),p(28,"input",22),t()()(),n(29,"div",9)(30,"h2"),i(31,"Physical Form"),t(),n(32,"div",10)(33,"div",11)(34,"label",23),i(35,"Inventory Form"),t(),n(36,"select",24)(37,"option",19),i(38,"Select form..."),t(),f(39,je,2,2,"option",20),t()(),f(40,Ue,5,1,"div",25),t(),f(41,Qe,3,2,"div",26)(42,$e,3,1,"div",27),t(),n(43,"div",9)(44,"h2"),i(45,"Quantity"),t(),n(46,"div",10)(47,"div",11)(48,"label",28),i(49,"Quantity *"),t(),p(50,"input",29),f(51,He,2,1,"span",14),t(),n(52,"div",11)(53,"label",30),i(54,"Unit of Measure"),t(),p(55,"input",31),t()()(),f(56,Ye,17,0,"div",32),n(57,"div",33)(58,"button",34),v("click",function(){m(e);let l=s();return u(l.cancel())}),i(59," Cancel "),t(),n(60,"button",35),i(61),t()()()()}if(o&2){let e=s();r(),c("formGroup",e.form),r(),c("ngIf",e.error),r(8),C("error",e.hasError("materialId")),r(),c("ngIf",e.hasError("materialId")),r(9),C("error",e.hasError("inventoryType")),r(3),c("ngForOf",e.inventoryTypes),r(),c("ngIf",e.hasError("inventoryType")),r(15),c("ngForOf",e.inventoryForms),r(),c("ngIf",e.selectedFormConfig==null?null:e.selectedFormConfig.tracks_temperature),r(),c("ngIf",(e.selectedFormConfig==null?null:e.selectedFormConfig.tracks_moisture)||(e.selectedFormConfig==null?null:e.selectedFormConfig.tracks_density)),r(),c("ngIf",e.handlingNotes),r(8),C("error",e.hasError("quantity")),r(),c("ngIf",e.hasError("quantity")),r(5),c("ngIf",e.isEditMode),r(2),c("disabled",e.saving),r(2),c("disabled",e.saving||e.form.invalid),r(),x(" ",e.saving?"Saving...":e.isEditMode?"Update Inventory":"Create Inventory"," ")}}var ee=(()=>{class o{constructor(e,a,l,_){this.fb=e,this.apiService=a,this.route=l,this.router=_,this.isEditMode=!1,this.inventoryId=null,this.loading=!1,this.saving=!1,this.error="",this.inventoryTypes=["RM","IM","FG","WIP"],this.inventoryForms=[],this.selectedFormConfig=null,this.handlingNotes=""}ngOnInit(){this.initForm(),this.loadInventoryForms(),this.form.get("inventoryForm").valueChanges.subscribe(a=>{this.onFormChange(a)});let e=this.route.snapshot.paramMap.get("id");e&&(this.isEditMode=!0,this.inventoryId=+e,this.loadInventory())}initForm(){this.form=this.fb.group({materialId:["",[h.required,h.maxLength(100)]],materialName:["",h.maxLength(200)],inventoryType:["",h.required],quantity:[null,h.required],unit:["T",h.maxLength(20)],location:["",h.maxLength(200)],state:["AVAILABLE"],inventoryForm:[""],currentTemperature:[null],moistureContent:[null],density:[null]})}loadInventoryForms(){this.apiService.getInventoryForms().subscribe({next:e=>{this.inventoryForms=e},error:()=>{}})}onFormChange(e){if(!e){this.selectedFormConfig=null,this.handlingNotes="";return}this.apiService.getInventoryFormConfig(e).subscribe({next:a=>{this.selectedFormConfig=a,this.handlingNotes=a?.handling_notes||""},error:()=>{this.selectedFormConfig=null,this.handlingNotes=""}})}loadInventory(){this.inventoryId&&(this.loading=!0,this.apiService.getInventoryById(this.inventoryId).subscribe({next:e=>{this.form.patchValue({materialId:e.materialId,materialName:e.materialName||"",inventoryType:e.inventoryType,quantity:e.quantity,unit:e.unit||"T",location:e.location||"",state:e.state,inventoryForm:e.inventoryForm||"",currentTemperature:e.currentTemperature||null,moistureContent:e.moistureContent||null,density:e.density||null}),this.loading=!1},error:e=>{this.error=e.error?.message||"Failed to load inventory.",this.loading=!1}}))}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.saving=!0,this.error="";let e=this.form.getRawValue();if(this.isEditMode&&this.inventoryId){let a={materialId:e.materialId,materialName:e.materialName||void 0,inventoryType:e.inventoryType,quantity:e.quantity,unit:e.unit||void 0,location:e.location||void 0,state:e.state,inventoryForm:e.inventoryForm||void 0,currentTemperature:e.currentTemperature,moistureContent:e.moistureContent,density:e.density};this.apiService.updateInventory(this.inventoryId,a).subscribe({next:()=>{this.saving=!1,this.router.navigate(["/inventory"])},error:l=>{this.saving=!1,this.error=l.error?.message||"Failed to update inventory."}})}else{let a={materialId:e.materialId,materialName:e.materialName||void 0,inventoryType:e.inventoryType,quantity:e.quantity,unit:e.unit||void 0,location:e.location||void 0,inventoryForm:e.inventoryForm||void 0,currentTemperature:e.currentTemperature,moistureContent:e.moistureContent,density:e.density};this.apiService.createInventory(a).subscribe({next:()=>{this.saving=!1,this.router.navigate(["/inventory"])},error:l=>{this.saving=!1,this.error=l.error?.message||"Failed to create inventory."}})}}cancel(){this.router.navigate(["/inventory"])}hasError(e){let a=this.form.get(e);return!!(a&&a.invalid&&a.touched)}getError(e){let a=this.form.get(e);return!a||!a.errors?"":a.errors.required?"This field is required":a.errors.maxlength?"Value is too long":"Invalid value"}static{this.\u0275fac=function(a){return new(a||o)(b(W),b(P),b(k),b(M))}}static{this.\u0275cmp=E({type:o,selectors:[["app-inventory-form"]],decls:6,vars:3,consts:[[1,"inventory-form-page"],[1,"page-header"],[1,"page-title"],["class","loading",4,"ngIf"],["class","form-container",4,"ngIf"],[1,"loading"],[1,"form-container"],[3,"ngSubmit","formGroup"],["class","error-banner",4,"ngIf"],[1,"form-section"],[1,"form-row"],[1,"form-group"],["for","materialId"],["type","text","id","materialId","formControlName","materialId","placeholder","e.g., MAT-001"],["class","error-text",4,"ngIf"],["for","materialName"],["type","text","id","materialName","formControlName","materialName","placeholder","Enter material name"],["for","inventoryType"],["id","inventoryType","formControlName","inventoryType"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","location"],["type","text","id","location","formControlName","location","placeholder","e.g., Warehouse A, Shelf 3"],["for","inventoryForm"],["id","inventoryForm","formControlName","inventoryForm"],["class","form-group",4,"ngIf"],["class","form-row",4,"ngIf"],["class","handling-notes",4,"ngIf"],["for","quantity"],["type","number","id","quantity","formControlName","quantity","placeholder","e.g., 1000","step","0.01"],["for","unit"],["type","text","id","unit","formControlName","unit","placeholder","e.g., T, KG, PCS"],["class","form-section",4,"ngIf"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"error-banner"],[1,"error-text"],[3,"value"],["for","currentTemperature"],["type","number","id","currentTemperature","formControlName","currentTemperature","step","0.1","placeholder","e.g., 25.0"],["class","hint-text",4,"ngIf"],[1,"hint-text"],["for","moistureContent"],["type","number","id","moistureContent","formControlName","moistureContent","step","0.1","placeholder","e.g., 5.0"],["for","density"],["type","number","id","density","formControlName","density","step","0.01","placeholder","e.g., 7800"],[1,"handling-notes"],[1,"fas","fa-triangle-exclamation"],["for","state"],["id","state","formControlName","state"],["value","AVAILABLE"],["value","RESERVED"],["value","PRODUCED"],["value","BLOCKED"],["value","ON_HOLD"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),i(3),t()(),f(4,De,2,0,"div",3)(5,Ze,62,20,"div",4),t()),a&2&&(r(3),g(l.isEditMode?"Edit Inventory":"New Inventory"),r(),c("ngIf",l.loading),r(),c("ngIf",!l.loading))},dependencies:[O,S,z,N,F,w,q,U,T,A,j,G],styles:[".inventory-form-page[_ngcontent-%COMP%]{padding:20px;max-width:800px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;color:#333}.loading[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#666}.form-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:24px}.error-banner[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:12px 16px;border-radius:4px;margin-bottom:20px}.form-section[_ngcontent-%COMP%]{margin-bottom:32px}.form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin:0 0 16px;padding-bottom:8px;border-bottom:1px solid #eee}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:16px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#555;font-size:14px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select.error[_ngcontent-%COMP%]{border-color:#d32f2f}.error-text[_ngcontent-%COMP%]{font-size:12px;color:#d32f2f}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding-top:20px;border-top:1px solid #eee}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-size:14px;font-weight:500;transition:background .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#1976d2;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#1565c0}.btn-secondary[_ngcontent-%COMP%]{background:#757575;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#616161}.hint-text[_ngcontent-%COMP%]{font-size:12px;color:#666}.handling-notes[_ngcontent-%COMP%]{background:#fff3cd;border:1px solid #ffc107;border-radius:4px;padding:10px 14px;font-size:13px;color:#856404;margin-top:12px}.handling-notes[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:6px}@media (max-width: 600px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return o})();function Je(o,d){if(o&1){let e=y();n(0,"button",16),v("click",function(){m(e);let l=s(2);return u(l.blockInventory())}),p(1,"i",17),i(2," Block "),t()}}function Xe(o,d){if(o&1){let e=y();n(0,"button",18),v("click",function(){m(e);let l=s(2);return u(l.unblockInventory())}),p(1,"i",19),i(2," Unblock "),t()}}function et(o,d){if(o&1){let e=y();n(0,"button",20),v("click",function(){m(e);let l=s(2);return u(l.scrapInventory())}),p(1,"i",21),i(2," Scrap "),t()}}function tt(o,d){if(o&1){let e=y();n(0,"div",10)(1,"button",11),v("click",function(){m(e);let l=s();return u(l.editInventory())}),p(2,"i",12),i(3," Edit "),t(),f(4,Je,3,0,"button",13)(5,Xe,3,0,"button",14)(6,et,3,0,"button",15),t()}if(o&2){let e=s();r(4),c("ngIf",e.inventory.state==="AVAILABLE"),r(),c("ngIf",e.inventory.state==="BLOCKED"),r(),c("ngIf",e.inventory.state==="AVAILABLE"||e.inventory.state==="BLOCKED")}}function nt(o,d){o&1&&(n(0,"div",22),p(1,"app-loading-spinner",23),t())}function it(o,d){if(o&1&&(n(0,"div",24),i(1),t()),o&2){let e=s();r(),x(" ",e.error," ")}}function ot(o,d){if(o&1){let e=y();n(0,"div",32)(1,"h3"),i(2,"Batch Information"),t(),n(3,"div",33)(4,"span",34),i(5,"Batch ID"),t(),n(6,"span",35),i(7),t()(),n(8,"div",33)(9,"span",34),i(10,"Batch Number"),t(),n(11,"span",41),v("click",function(){m(e);let l=s(2);return u(l.viewBatch())}),i(12),t()()()}if(o&2){let e=s(2);r(7),g(e.inventory.batchId),r(5),g(e.inventory.batchNumber)}}function rt(o,d){if(o&1&&(n(0,"div",32)(1,"h3"),i(2,"Block Information"),t(),n(3,"div",33)(4,"span",34),i(5,"Reason"),t(),n(6,"span",35),i(7),t()(),n(8,"div",33)(9,"span",34),i(10,"Blocked By"),t(),n(11,"span",35),i(12),t()(),n(13,"div",33)(14,"span",34),i(15,"Blocked On"),t(),n(16,"span",35),i(17),D(18,"date"),t()()()),o&2){let e=s(2);r(7),g(e.inventory.blockReason),r(5),g(e.inventory.blockedBy),r(5),g(B(18,3,e.inventory.blockedOn,"medium"))}}function at(o,d){if(o&1&&(n(0,"div",32)(1,"h3"),i(2,"Scrap Information"),t(),n(3,"div",33)(4,"span",34),i(5,"Reason"),t(),n(6,"span",35),i(7),t()(),n(8,"div",33)(9,"span",34),i(10,"Scrapped By"),t(),n(11,"span",35),i(12),t()(),n(13,"div",33)(14,"span",34),i(15,"Scrapped On"),t(),n(16,"span",35),i(17),D(18,"date"),t()()()),o&2){let e=s(2);r(7),g(e.inventory.scrapReason),r(5),g(e.inventory.scrappedBy),r(5),g(B(18,3,e.inventory.scrappedOn,"medium"))}}function lt(o,d){if(o&1&&(n(0,"div",33)(1,"span",34),i(2,"Reserved Quantity"),t(),n(3,"span",35),i(4),t()()),o&2){let e=s(3);r(4),I("",e.inventory.reservedQty," ",e.inventory.unit,"")}}function ct(o,d){if(o&1&&(n(0,"div",32)(1,"h3"),i(2,"Reservation Information"),t(),n(3,"div",33)(4,"span",34),i(5,"Reserved For Order"),t(),n(6,"span",35),i(7),t()(),n(8,"div",33)(9,"span",34),i(10,"Reserved For Operation"),t(),n(11,"span",35),i(12),t()(),n(13,"div",33)(14,"span",34),i(15,"Reserved By"),t(),n(16,"span",35),i(17),t()(),n(18,"div",33)(19,"span",34),i(20,"Reserved On"),t(),n(21,"span",35),i(22),D(23,"date"),t()(),f(24,lt,5,2,"div",42),t()),o&2){let e=s(2);r(7),g(e.inventory.reservedForOrderId||"-"),r(5),g(e.inventory.reservedForOperationId||"-"),r(5),g(e.inventory.reservedBy),r(5),g(B(23,5,e.inventory.reservedOn,"medium")),r(2),c("ngIf",e.inventory.reservedQty)}}function st(o,d){if(o&1&&(n(0,"div",25)(1,"div",26)(2,"div",27)(3,"div",28)(4,"h2"),i(5),t(),n(6,"span",29),i(7),t()(),n(8,"span",30),i(9),t()(),n(10,"div",31)(11,"div",32)(12,"h3"),i(13,"Basic Information"),t(),n(14,"div",33)(15,"span",34),i(16,"Inventory ID"),t(),n(17,"span",35),i(18),t()(),n(19,"div",33)(20,"span",34),i(21,"Material ID"),t(),n(22,"span",36),i(23),t()(),n(24,"div",33)(25,"span",34),i(26,"Type"),t(),n(27,"span",35),i(28),t()(),n(29,"div",33)(30,"span",34),i(31,"Location"),t(),n(32,"span",35),i(33),t()()(),n(34,"div",32)(35,"h3"),i(36,"Quantity"),t(),n(37,"div",37)(38,"span",38),i(39),t(),n(40,"span",39),i(41),t()()(),f(42,ot,13,2,"div",40)(43,rt,19,6,"div",40)(44,at,19,6,"div",40)(45,ct,25,8,"div",40),t()()()),o&2){let e=s();r(5),g(e.inventory.materialName),r(),c("ngClass",e.getTypeClass(e.inventory.inventoryType)),r(),x(" ",e.getTypeLabel(e.inventory.inventoryType)," "),r(),c("ngClass",e.getStateClass(e.inventory.state)),r(),x(" ",e.inventory.state," "),r(9),g(e.inventory.inventoryId),r(5),g(e.inventory.materialId),r(5),g(e.getTypeLabel(e.inventory.inventoryType)),r(5),g(e.inventory.location||"-"),r(6),g(e.inventory.quantity),r(2),g(e.inventory.unit),r(),c("ngIf",e.inventory.batchId),r(),c("ngIf",e.inventory.state==="BLOCKED"),r(),c("ngIf",e.inventory.state==="SCRAPPED"),r(),c("ngIf",e.inventory.state==="RESERVED")}}var ve=(()=>{class o{constructor(e,a,l){this.route=e,this.router=a,this.apiService=l,this.inventory=null,this.loading=!0,this.error=null,this.typeLabels={RM:"Raw Material",IM:"Intermediate",FG:"Finished Goods",WIP:"Work In Progress"}}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e?this.loadInventory(+e):(this.error="No inventory ID provided",this.loading=!1)}loadInventory(e){this.loading=!0,this.error=null,this.apiService.getInventoryById(e).subscribe({next:a=>{this.inventory=a,this.loading=!1},error:a=>{console.error("Error loading inventory:",a),this.error="Failed to load inventory",this.loading=!1}})}editInventory(){this.inventory&&this.router.navigate(["/inventory",this.inventory.inventoryId,"edit"])}viewBatch(){this.inventory?.batchId&&this.router.navigate(["/batches",this.inventory.batchId])}goBack(){this.router.navigate(["/inventory"])}getStateClass(e){switch(e?.toUpperCase()){case"AVAILABLE":return"state-available";case"CONSUMED":return"state-consumed";case"RESERVED":return"state-reserved";case"PRODUCED":return"state-produced";case"BLOCKED":return"state-blocked";case"SCRAPPED":return"state-scrapped";default:return""}}getTypeLabel(e){return this.typeLabels[e]||e}getTypeClass(e){switch(e){case"RM":return"type-rm";case"IM":return"type-im";case"FG":return"type-fg";case"WIP":return"type-wip";default:return""}}blockInventory(){if(!this.inventory)return;let e=prompt("Enter block reason:");e&&this.apiService.blockInventory(this.inventory.inventoryId,e).subscribe({next:()=>{this.loadInventory(this.inventory.inventoryId)},error:a=>{console.error("Error blocking inventory:",a),this.error="Failed to block inventory"}})}unblockInventory(){this.inventory&&this.apiService.unblockInventory(this.inventory.inventoryId).subscribe({next:()=>{this.loadInventory(this.inventory.inventoryId)},error:e=>{console.error("Error unblocking inventory:",e),this.error="Failed to unblock inventory"}})}scrapInventory(){if(!this.inventory)return;let e=prompt("Enter scrap reason:");e&&confirm("Are you sure you want to scrap this inventory? This action cannot be undone.")&&this.apiService.scrapInventory(this.inventory.inventoryId,e).subscribe({next:()=>{this.loadInventory(this.inventory.inventoryId)},error:a=>{console.error("Error scrapping inventory:",a),this.error="Failed to scrap inventory"}})}static{this.\u0275fac=function(a){return new(a||o)(b(k),b(M),b(P))}}static{this.\u0275cmp=E({type:o,selectors:[["app-inventory-detail"]],decls:12,vars:4,consts:[[1,"detail-container"],[1,"page-header"],[1,"header-left"],[1,"btn","btn-back",3,"click"],[1,"fas","fa-arrow-left"],[1,"page-title"],["class","header-actions",4,"ngIf"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],["class","detail-content",4,"ngIf"],[1,"header-actions"],[1,"btn","btn-secondary",3,"click"],[1,"fas","fa-edit"],["class","btn btn-warning",3,"click",4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],["class","btn btn-danger",3,"click",4,"ngIf"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-ban"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-check"],[1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"loading"],["message","Loading inventory..."],[1,"error-message"],[1,"detail-content"],[1,"detail-card"],[1,"card-header"],[1,"header-title"],[1,"type-badge",3,"ngClass"],[1,"state-badge",3,"ngClass"],[1,"detail-grid"],[1,"detail-section"],[1,"detail-row"],[1,"label"],[1,"value"],[1,"value","code"],[1,"quantity-display"],[1,"qty-value"],[1,"qty-unit"],["class","detail-section",4,"ngIf"],[1,"value","link",3,"click"],["class","detail-row",4,"ngIf"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),v("click",function(){return l.goBack()}),p(4,"i",4),i(5," Back "),t(),n(6,"h1",5),i(7,"Inventory Details"),t()(),f(8,tt,7,3,"div",6),t(),f(9,nt,2,0,"div",7)(10,it,2,1,"div",8)(11,st,46,15,"div",9),t()),a&2&&(r(8),c("ngIf",l.inventory),r(),c("ngIf",l.loading),r(),c("ngIf",l.error),r(),c("ngIf",!l.loading&&l.inventory))},dependencies:[ne,S,K,ie],styles:[".detail-container[_ngcontent-%COMP%]{padding:24px}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:600;color:#1e293b}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:48px}.error-message[_ngcontent-%COMP%]{background:#fef2f2;border:1px solid #fecaca;color:#dc2626;padding:12px 16px;border-radius:8px;margin-bottom:16px}.detail-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.detail-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e2e8f0;border-radius:8px;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;background:#f8fafc;border-bottom:1px solid #e2e8f0}.header-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#1e293b}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;padding:24px}.detail-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:14px;font-weight:600;color:#64748b;text-transform:uppercase;letter-spacing:.05em}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f1f5f9}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.label[_ngcontent-%COMP%]{color:#64748b;font-size:14px}.value[_ngcontent-%COMP%]{color:#1e293b;font-weight:500;font-size:14px}.value.code[_ngcontent-%COMP%]{font-family:monospace;background:#f1f5f9;padding:2px 8px;border-radius:4px}.value.link[_ngcontent-%COMP%]{color:#3b82f6;cursor:pointer}.value.link[_ngcontent-%COMP%]:hover{text-decoration:underline}.quantity-display[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:8px;padding:16px;background:#f8fafc;border-radius:8px}.qty-value[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#1e293b}.qty-unit[_ngcontent-%COMP%]{font-size:16px;color:#64748b}.state-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 12px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.state-available[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.state-consumed[_ngcontent-%COMP%]{background:#f1f5f9;color:#64748b}.state-reserved[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.state-produced[_ngcontent-%COMP%]{background:#f3e8ff;color:#7c3aed}.state-blocked[_ngcontent-%COMP%]{background:#fef3c7;color:#b45309}.state-scrapped[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626}.type-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;border-radius:6px;font-size:12px;font-weight:500}.type-rm[_ngcontent-%COMP%]{background:#dbeafe;color:#1d4ed8}.type-im[_ngcontent-%COMP%]{background:#fef3c7;color:#b45309}.type-fg[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.type-wip[_ngcontent-%COMP%]{background:#f3e8ff;color:#7c3aed}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:background-color .2s}.btn-back[_ngcontent-%COMP%]{background:transparent;color:#64748b;padding:8px 12px}.btn-back[_ngcontent-%COMP%]:hover{background:#f1f5f9;color:#1e293b}.btn-secondary[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e2e8f0}.btn-warning[_ngcontent-%COMP%]{background:#fef3c7;color:#b45309;border:1px solid #fcd34d}.btn-warning[_ngcontent-%COMP%]:hover{background:#fde68a}.btn-danger[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.btn-danger[_ngcontent-%COMP%]:hover{background:#fee2e2}.btn-success[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}.btn-success[_ngcontent-%COMP%]:hover{background:#bbf7d0}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.header-actions[_ngcontent-%COMP%]{flex-wrap:wrap}.detail-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return o})();function dt(o,d){if(o&1){let e=y();n(0,"div",6)(1,"div",7),p(2,"i",8),t(),n(3,"div",9)(4,"h2"),i(5,"Material Received Successfully"),t(),n(6,"p"),i(7),t(),n(8,"div",10)(9,"div",11)(10,"span",12),i(11,"Batch Number:"),t(),n(12,"span",13),i(13),t()(),n(14,"div",11)(15,"span",12),i(16,"Batch Status:"),t(),n(17,"span",14),i(18),t()(),n(19,"div",11)(20,"span",12),i(21,"Inventory State:"),t(),n(22,"span",15),i(23),t()(),n(24,"div",11)(25,"span",12),i(26,"Quantity:"),t(),n(27,"span",13),i(28),t()()(),n(29,"div",16)(30,"button",17),v("click",function(){m(e);let l=s();return u(l.viewBatch())}),p(31,"i",18),i(32," View Batch "),t(),n(33,"button",17),v("click",function(){m(e);let l=s();return u(l.viewInventory())}),p(34,"i",19),i(35," View Inventory "),t(),n(36,"button",20),v("click",function(){m(e);let l=s();return u(l.receiveAnother())}),p(37,"i",21),i(38," Receive Another "),t()()()()}if(o&2){let e=s();r(7),g(e.successMessage),r(6),g(e.receiptResult.batchNumber),r(5),g(e.receiptResult.batchStatus),r(5),g(e.receiptResult.inventoryState),r(5),I("",e.receiptResult.quantity," ",e.receiptResult.unit,"")}}function pt(o,d){if(o&1&&(n(0,"div",63),p(1,"i",64),i(2),t()),o&2){let e=s(2);r(2),x(" ",e.error," ")}}function mt(o,d){if(o&1&&(n(0,"option",65),i(1),t()),o&2){let e=d.$implicit;c("value",e.materialCode),r(),I(" ",e.materialCode," - ",e.materialName," ")}}function ut(o,d){if(o&1&&(n(0,"span",66),i(1),t()),o&2){let e=s(2);r(),x(" ",e.getError("materialId")," ")}}function vt(o,d){o&1&&(n(0,"span",42),i(1,"Loading materials..."),t())}function gt(o,d){o&1&&(n(0,"span",42),i(1," No raw materials configured. Add materials in Master Data first. "),t())}function ft(o,d){if(o&1&&(n(0,"span",66),i(1),t()),o&2){let e=s(2);r(),x(" ",e.getError("quantity")," ")}}function _t(o,d){if(o&1&&(n(0,"span",66),i(1),t()),o&2){let e=s(2);r(),x(" ",e.getError("unit")," ")}}function xt(o,d){o&1&&p(0,"i",67)}function yt(o,d){if(o&1){let e=y();n(0,"div",22)(1,"form",23),v("ngSubmit",function(){m(e);let l=s();return u(l.onSubmit())}),f(2,pt,3,1,"div",24),n(3,"div",25)(4,"h2"),p(5,"i",26),i(6," Material Information"),t(),n(7,"div",27)(8,"div",28)(9,"label",29),i(10,"Material *"),t(),n(11,"select",30),v("change",function(l){m(e);let _=s();return u(_.onMaterialChange(l))}),n(12,"option",31),i(13,"Select raw material..."),t(),f(14,mt,2,3,"option",32),t(),f(15,ut,2,1,"span",33)(16,vt,2,0,"span",34)(17,gt,2,0,"span",34),t(),n(18,"div",28)(19,"label",35),i(20,"Material Name"),t(),p(21,"input",36),t()()(),n(22,"div",25)(23,"h2"),p(24,"i",37),i(25," Supplier Information"),t(),n(26,"div",27)(27,"div",28)(28,"label",38),i(29,"Supplier ID"),t(),p(30,"input",39),t(),n(31,"div",28)(32,"label",40),i(33,"Supplier Batch Number"),t(),p(34,"input",41),n(35,"span",42),i(36,"External batch number from supplier's documentation"),t()()()(),n(37,"div",25)(38,"h2"),p(39,"i",43),i(40," Quantity"),t(),n(41,"div",27)(42,"div",28)(43,"label",44),i(44,"Quantity *"),t(),p(45,"input",45),f(46,ft,2,1,"span",33),t(),n(47,"div",28)(48,"label",46),i(49,"Unit of Measure *"),t(),p(50,"input",47),f(51,_t,2,1,"span",33),n(52,"span",42),i(53,"System units: KG, TONS, PCS, M, L"),t()()()(),n(54,"div",25)(55,"h2"),p(56,"i",48),i(57," Receipt Details"),t(),n(58,"div",27)(59,"div",28)(60,"label",49),i(61,"Received Date"),t(),p(62,"input",50),t(),n(63,"div",28)(64,"label",51),i(65,"Storage Location"),t(),p(66,"input",52),t()(),n(67,"div",53)(68,"label",54),i(69,"Notes"),t(),p(70,"textarea",55),t()(),n(71,"div",56),p(72,"i",57),n(73,"div",58)(74,"strong"),i(75,"What happens on submit:"),t(),n(76,"ul")(77,"li"),i(78,"A new "),n(79,"strong"),i(80,"Batch"),t(),i(81," is created with status "),n(82,"strong"),i(83,"QUALITY_PENDING"),t()(),n(84,"li"),i(85,"An "),n(86,"strong"),i(87,"Inventory"),t(),i(88," record is created with state "),n(89,"strong"),i(90,"AVAILABLE"),t()(),n(91,"li"),i(92,"An "),n(93,"strong"),i(94,"Inventory Movement"),t(),i(95," (RECEIVE) is logged for traceability"),t(),n(96,"li"),i(97,"The batch requires quality approval before it can be consumed in production"),t()()()(),n(98,"div",59)(99,"button",60),v("click",function(){m(e);let l=s();return u(l.cancel())}),i(100," Cancel "),t(),n(101,"button",61),f(102,xt,1,0,"i",62),i(103),t()()()()}if(o&2){let e=s();r(),c("formGroup",e.form),r(),c("ngIf",e.error),r(9),C("error",e.hasError("materialId")),r(3),c("ngForOf",e.materials),r(),c("ngIf",e.hasError("materialId")),r(),c("ngIf",e.loadingMaterials),r(),c("ngIf",!e.loadingMaterials&&e.materials.length===0),r(28),C("error",e.hasError("quantity")),r(),c("ngIf",e.hasError("quantity")),r(4),C("error",e.hasError("unit")),r(),c("ngIf",e.hasError("unit")),r(48),c("disabled",e.saving),r(2),c("disabled",e.saving||e.form.invalid),r(),c("ngIf",!e.saving),r(),x(" ",e.saving?"Receiving...":"Receive Material"," ")}}var ge=(()=>{class o{constructor(e,a,l){this.fb=e,this.apiService=a,this.router=l,this.loading=!1,this.saving=!1,this.error="",this.successMessage="",this.materials=[],this.loadingMaterials=!1,this.receiptResult=null}ngOnInit(){this.initForm(),this.loadMaterials()}initForm(){let e=new Date().toISOString().split("T")[0];this.form=this.fb.group({materialId:["",[h.required]],materialName:[""],quantity:[null,[h.required,h.min(1e-4)]],unit:["KG",[h.required,h.maxLength(20)]],supplierBatchNumber:["",h.maxLength(100)],supplierId:["",h.maxLength(50)],receivedDate:[e],location:["",h.maxLength(200)],notes:["",h.maxLength(500)]})}loadMaterials(){this.loadingMaterials=!0,this.apiService.getActiveMaterials().subscribe({next:e=>{this.materials=e.filter(a=>a.materialType==="RM"),this.loadingMaterials=!1},error:e=>{console.error("Failed to load materials:",e),this.loadingMaterials=!1}})}onMaterialChange(e){let l=e.target.value;if(l){let _=this.materials.find(_e=>_e.materialCode===l);_&&this.form.patchValue({materialName:_.materialName,unit:_.baseUnit||"KG"})}else this.form.patchValue({materialName:"",unit:"KG"})}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}this.saving=!0,this.error="",this.successMessage="",this.receiptResult=null;let e=this.form.getRawValue(),a={materialId:e.materialId,materialName:e.materialName||void 0,quantity:e.quantity,unit:e.unit||void 0,supplierBatchNumber:e.supplierBatchNumber||void 0,supplierId:e.supplierId||void 0,receivedDate:e.receivedDate||void 0,location:e.location||void 0,notes:e.notes||void 0};this.apiService.receiveMaterial(a).subscribe({next:l=>{this.saving=!1,this.receiptResult=l,this.successMessage=l.message,this.initForm()},error:l=>{this.saving=!1,this.error=l.error?.message||"Failed to receive material."}})}cancel(){this.router.navigate(["/inventory"])}viewBatch(){this.receiptResult?.batchId&&this.router.navigate(["/batches",this.receiptResult.batchId])}viewInventory(){this.receiptResult?.inventoryId&&this.router.navigate(["/inventory",this.receiptResult.inventoryId])}receiveAnother(){this.receiptResult=null,this.successMessage="",this.error=""}hasError(e){let a=this.form.get(e);return!!(a&&a.invalid&&a.touched)}getError(e){let a=this.form.get(e);return!a||!a.errors?"":a.errors.required?"This field is required":a.errors.maxlength?"Value is too long":a.errors.min?"Quantity must be greater than 0":"Invalid value"}static{this.\u0275fac=function(a){return new(a||o)(b(W),b(P),b(M))}}static{this.\u0275cmp=E({type:o,selectors:[["app-receive-material"]],decls:8,vars:2,consts:[[1,"receive-material-page"],[1,"page-header"],[1,"page-title"],[1,"subtitle"],["class","result-card success",4,"ngIf"],["class","form-container",4,"ngIf"],[1,"result-card","success"],[1,"result-icon"],[1,"fas","fa-check-circle"],[1,"result-content"],[1,"result-details"],[1,"detail-row"],[1,"label"],[1,"value"],[1,"value","status-badge","pending"],[1,"value","status-badge","available"],[1,"result-actions"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-cube"],[1,"fas","fa-boxes-stacked"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"form-container"],[3,"ngSubmit","formGroup"],["class","error-banner",4,"ngIf"],[1,"form-section"],[1,"fas","fa-box"],[1,"form-row"],[1,"form-group"],["for","materialId"],["id","materialId","formControlName","materialId",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","error-text",4,"ngIf"],["class","hint-text",4,"ngIf"],["for","materialName"],["type","text","id","materialName","formControlName","materialName","placeholder","Auto-filled from selection","readonly",""],[1,"fas","fa-truck"],["for","supplierId"],["type","text","id","supplierId","formControlName","supplierId","placeholder","e.g., SUP-001"],["for","supplierBatchNumber"],["type","text","id","supplierBatchNumber","formControlName","supplierBatchNumber","placeholder","For traceability"],[1,"hint-text"],[1,"fas","fa-weight"],["for","quantity"],["type","number","id","quantity","formControlName","quantity","placeholder","e.g., 1000","step","0.01","min","0"],["for","unit"],["type","text","id","unit","formControlName","unit","placeholder","e.g., KG, TONS, PCS"],[1,"fas","fa-clipboard-list"],["for","receivedDate"],["type","date","id","receivedDate","formControlName","receivedDate"],["for","location"],["type","text","id","location","formControlName","location","placeholder","e.g., Warehouse A, Bay 3"],[1,"form-group","full-width"],["for","notes"],["id","notes","formControlName","notes","placeholder","Delivery reference, inspection notes, etc.","rows","3"],[1,"info-card"],[1,"fas","fa-info-circle"],[1,"info-content"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","fas fa-download",4,"ngIf"],[1,"error-banner"],[1,"fas","fa-exclamation-circle"],[3,"value"],[1,"error-text"],[1,"fas","fa-download"]],template:function(a,l){a&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),i(3,"Receive Raw Material"),t(),n(4,"p",3),i(5,"Create batch and inventory record for incoming raw materials"),t()(),f(6,dt,39,6,"div",4)(7,yt,104,18,"div",5),t()),a&2&&(r(6),c("ngIf",l.receiptResult),r(),c("ngIf",!l.receiptResult))},dependencies:[O,S,z,N,F,w,q,U,T,A,ae,j,G],styles:[".receive-material-page[_ngcontent-%COMP%]{padding:24px;max-width:800px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#1a1a1a;margin:0 0 8px}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#666;margin:0;font-size:14px}.result-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:32px;display:flex;gap:24px;box-shadow:0 2px 8px #00000014}.result-card.success[_ngcontent-%COMP%]{border-left:4px solid #4caf50}.result-icon[_ngcontent-%COMP%]{font-size:48px;color:#4caf50}.result-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 8px;font-size:20px;color:#1a1a1a}.result-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin:0 0 24px}.result-details[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:8px;padding:16px;margin-bottom:24px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #eee}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666;font-weight:500}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#1a1a1a}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;border-radius:12px;font-size:12px;font-weight:600;text-transform:uppercase}.status-badge.pending[_ngcontent-%COMP%]{background:#fff3e0;color:#f57c00}.status-badge.available[_ngcontent-%COMP%]{background:#e8f5e9;color:#388e3c}.result-actions[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.form-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:24px;box-shadow:0 2px 8px #00000014}.error-banner[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;padding:12px 16px;border-radius:8px;margin-bottom:20px;display:flex;align-items:center;gap:8px}.form-section[_ngcontent-%COMP%]{margin-bottom:28px;padding-bottom:20px;border-bottom:1px solid #eee}.form-section[_ngcontent-%COMP%]:last-of-type{border-bottom:none;margin-bottom:16px}.form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1a1a1a;margin:0 0 16px;display:flex;align-items:center;gap:8px}.form-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#1976d2}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}@media (max-width: 600px){.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.form-group.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#333}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #ddd;border-radius:6px;font-size:14px;transition:border-color .2s,box-shadow .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2;box-shadow:0 0 0 3px #1976d21a}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select.error[_ngcontent-%COMP%]{border-color:#c62828}.form-group[_ngcontent-%COMP%]   input[readonly][_ngcontent-%COMP%]{background:#f5f5f5;cursor:not-allowed}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.error-text[_ngcontent-%COMP%]{font-size:12px;color:#c62828}.hint-text[_ngcontent-%COMP%]{font-size:12px;color:#666}.info-card[_ngcontent-%COMP%]{background:#e3f2fd;border-radius:8px;padding:16px;display:flex;gap:12px;margin-bottom:24px}.info-card[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#1976d2;font-size:20px;flex-shrink:0;margin-top:2px}.info-content[_ngcontent-%COMP%]{font-size:13px;color:#1565c0}.info-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:8px}.info-content[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:20px}.info-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding-top:16px;border-top:1px solid #eee}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:10px 20px;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;border:none;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#1976d2;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#1565c0}.btn-secondary[_ngcontent-%COMP%]{background:#f5f5f5;color:#333;border:1px solid #ddd}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#e0e0e0}"]})}}return o})();var ht=[{path:"",component:ue},{path:"new",component:ee},{path:"receive",component:ge},{path:":id",component:ve},{path:":id/edit",component:ee}],fe=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=L({type:o})}static{this.\u0275inj=V({imports:[Y.forChild(ht),Y]})}}return o})();var $t=(()=>{class o{static{this.\u0275fac=function(a){return new(a||o)}}static{this.\u0275mod=L({type:o})}static{this.\u0275inj=V({imports:[oe,le,ce,fe,pe]})}}return o})();export{$t as InventoryModule};

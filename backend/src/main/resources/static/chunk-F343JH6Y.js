import{a as H,b as z,c as F,d as B,e as D,f as W}from"./chunk-PSDCBCWL.js";import{A as f,B as y,E as b,F as M,G as S,N as O,O as L,R as T,ba as q,d as E,ea as I,f as w,g as C,ga as V,h as p,i as m,ia as k,k as l,l as P,m as g,o as c,qa as N,r as n,ra as R,s as t,t as v,u as x,v as u,w as s,wa as A,y as i,z as h}from"./chunk-SDYT7PYO.js";function Z(o,_){o&1&&(n(0,"div",6),v(1,"app-loading-spinner",7),t())}function J(o,_){if(o&1&&(n(0,"div",37),i(1),t()),o&2){let e=s().$implicit;l(),f(" ",e.maintenanceReason," ")}}function K(o,_){if(o&1&&(n(0,"div",37),i(1),t()),o&2){let e=s().$implicit;l(),f(" ",e.holdReason," ")}}function Q(o,_){if(o&1){let e=x();n(0,"button",38),u("click",function(){p(e);let a=s().$implicit,d=s(3);return m(d.openMaintenanceModal(a))}),i(1," Maintenance "),t()}}function X(o,_){if(o&1){let e=x();n(0,"button",39),u("click",function(){p(e);let a=s().$implicit,d=s(3);return m(d.endMaintenance(a))}),i(1," End Maintenance "),t()}}function Y(o,_){if(o&1){let e=x();n(0,"button",40),u("click",function(){p(e);let a=s().$implicit,d=s(3);return m(d.openHoldModal(a))}),i(1," Hold "),t()}}function ee(o,_){if(o&1){let e=x();n(0,"button",41),u("click",function(){p(e);let a=s().$implicit,d=s(3);return m(d.releaseFromHold(a))}),i(1," Release "),t()}}function te(o,_){o&1&&(n(0,"span",42),i(1,"In use"),t())}function ne(o,_){if(o&1&&(n(0,"tr")(1,"td"),i(2),t(),n(3,"td"),i(4),t(),n(5,"td"),i(6),t(),n(7,"td"),i(8),t(),n(9,"td"),i(10),t(),n(11,"td"),v(12,"app-status-badge",29),g(13,J,2,1,"div",30)(14,K,2,1,"div",30),t(),n(15,"td",31),g(16,Q,2,0,"button",32)(17,X,2,0,"button",33)(18,Y,2,0,"button",34)(19,ee,2,0,"button",35)(20,te,2,0,"span",36),t()()),o&2){let e=_.$implicit,r=s(3);l(2),h(e.equipmentCode),l(2),h(e.name),l(2),h(e.equipmentType),l(2),y("",e.capacity," ",e.capacityUnit,""),l(2),h(e.location||"-"),l(2),c("status",e.status),l(),c("ngIf",e.status==="MAINTENANCE"&&e.maintenanceReason),l(),c("ngIf",e.status==="ON_HOLD"&&e.holdReason),l(2),c("ngIf",r.canStartMaintenance(e)),l(),c("ngIf",r.canEndMaintenance(e)),l(),c("ngIf",r.canPutOnHold(e)),l(),c("ngIf",r.canReleaseFromHold(e)),l(),c("ngIf",e.status==="IN_USE")}}function ie(o,_){if(o&1&&(n(0,"table",27)(1,"thead")(2,"tr")(3,"th"),i(4,"Code"),t(),n(5,"th"),i(6,"Name"),t(),n(7,"th"),i(8,"Type"),t(),n(9,"th"),i(10,"Capacity"),t(),n(11,"th"),i(12,"Location"),t(),n(13,"th"),i(14,"Status"),t(),n(15,"th"),i(16,"Actions"),t()()(),n(17,"tbody"),g(18,ne,21,14,"tr",28),t()()),o&2){let e=s(2);l(18),c("ngForOf",e.equipment)}}function oe(o,_){o&1&&(n(0,"p",43),i(1," No equipment found matching the selected filters. "),t())}function ae(o,_){if(o&1){let e=x();n(0,"app-pagination",44),u("pageChange",function(a){p(e);let d=s(2);return m(d.onPageChange(a))})("sizeChange",function(a){p(e);let d=s(2);return m(d.onSizeChange(a))}),t()}if(o&2){let e=s(2);c("page",e.page)("size",e.size)("totalElements",e.totalElements)("totalPages",e.totalPages)("hasNext",e.hasNext)("hasPrevious",e.hasPrevious)}}function re(o,_){if(o&1){let e=x();n(0,"div")(1,"div",8)(2,"div",9)(3,"div",10)(4,"label"),i(5,"Status:"),t(),n(6,"select",11),u("change",function(a){p(e);let d=s();return m(d.onFilterStatusChange(a.target.value))}),n(7,"option",12),i(8,"All Statuses"),t(),n(9,"option",13),i(10,"Available"),t(),n(11,"option",14),i(12,"In Use"),t(),n(13,"option",15),i(14,"Maintenance"),t(),n(15,"option",16),i(16,"On Hold"),t(),n(17,"option",17),i(18,"Unavailable"),t()()(),n(19,"div",10)(20,"label"),i(21,"Type:"),t(),n(22,"select",11),u("change",function(a){p(e);let d=s();return m(d.onFilterTypeChange(a.target.value))}),n(23,"option",12),i(24,"All Types"),t(),n(25,"option",18),i(26,"Furnace"),t(),n(27,"option",19),i(28,"Caster"),t(),n(29,"option",20),i(30,"Rolling Mill"),t(),n(31,"option",21),i(32,"Batch"),t()()(),n(33,"div",22)(34,"label"),i(35,"Search:"),t(),n(36,"input",23),u("input",function(a){p(e);let d=s();return m(d.onSearchChange(a.target.value))}),t()()()(),n(37,"div",8),g(38,ie,19,1,"table",24)(39,oe,2,0,"p",25)(40,ae,1,6,"app-pagination",26),t()()}if(o&2){let e=s();l(6),c("value",e.filterStatus||"all"),l(16),c("value",e.filterType||"all"),l(14),c("value",e.searchTerm),l(2),c("ngIf",e.equipment.length>0),l(),c("ngIf",e.equipment.length===0),l(),c("ngIf",e.equipment.length>0)}}function le(o,_){if(o&1&&(n(0,"div",59),i(1),t()),o&2){let e=s(2);l(),h(e.actionError)}}function se(o,_){if(o&1){let e=x();n(0,"div",45),u("click",function(){p(e);let a=s();return m(a.closeMaintenanceModal())}),n(1,"div",46),u("click",function(a){return p(e),m(a.stopPropagation())}),n(2,"div",47)(3,"h3"),i(4,"Start Maintenance"),t(),n(5,"button",48),u("click",function(){p(e);let a=s();return m(a.closeMaintenanceModal())}),i(6,"\xD7"),t()(),n(7,"div",49)(8,"p"),i(9,"Starting maintenance for:"),t(),n(10,"p")(11,"strong"),i(12,"Equipment:"),t(),i(13),t(),n(14,"p")(15,"strong"),i(16,"Name:"),t(),i(17),t(),n(18,"div",50)(19,"label",51),i(20,"Reason for Maintenance *"),t(),n(21,"textarea",52),S("ngModelChange",function(a){p(e);let d=s();return M(d.actionReason,a)||(d.actionReason=a),m(a)}),t()(),n(22,"div",50)(23,"label",53),i(24,"Expected End Time (Optional)"),t(),n(25,"input",54),S("ngModelChange",function(a){p(e);let d=s();return M(d.expectedEndTime,a)||(d.expectedEndTime=a),m(a)}),t()(),g(26,le,2,1,"div",55),t(),n(27,"div",56)(28,"button",57),u("click",function(){p(e);let a=s();return m(a.closeMaintenanceModal())}),i(29,"Cancel"),t(),n(30,"button",58),u("click",function(){p(e);let a=s();return m(a.confirmStartMaintenance())}),i(31),t()()()()}if(o&2){let e=s();l(13),f(" ",e.selectedEquipment==null?null:e.selectedEquipment.equipmentCode,""),l(4),f(" ",e.selectedEquipment==null?null:e.selectedEquipment.name,""),l(4),b("ngModel",e.actionReason),l(4),b("ngModel",e.expectedEndTime),l(),c("ngIf",e.actionError),l(2),c("disabled",e.actionLoading),l(2),c("disabled",e.actionLoading),l(),f(" ",e.actionLoading?"Starting...":"Start Maintenance"," ")}}function ce(o,_){if(o&1&&(n(0,"div",59),i(1),t()),o&2){let e=s(2);l(),h(e.actionError)}}function de(o,_){if(o&1){let e=x();n(0,"div",45),u("click",function(){p(e);let a=s();return m(a.closeHoldModal())}),n(1,"div",46),u("click",function(a){return p(e),m(a.stopPropagation())}),n(2,"div",47)(3,"h3"),i(4,"Put Equipment on Hold"),t(),n(5,"button",48),u("click",function(){p(e);let a=s();return m(a.closeHoldModal())}),i(6,"\xD7"),t()(),n(7,"div",49)(8,"p"),i(9,"Putting equipment on hold:"),t(),n(10,"p")(11,"strong"),i(12,"Equipment:"),t(),i(13),t(),n(14,"p")(15,"strong"),i(16,"Name:"),t(),i(17),t(),n(18,"div",50)(19,"label",60),i(20,"Reason for Hold *"),t(),n(21,"textarea",61),S("ngModelChange",function(a){p(e);let d=s();return M(d.actionReason,a)||(d.actionReason=a),m(a)}),t()(),g(22,ce,2,1,"div",55),t(),n(23,"div",56)(24,"button",57),u("click",function(){p(e);let a=s();return m(a.closeHoldModal())}),i(25,"Cancel"),t(),n(26,"button",58),u("click",function(){p(e);let a=s();return m(a.confirmPutOnHold())}),i(27),t()()()()}if(o&2){let e=s();l(13),f(" ",e.selectedEquipment==null?null:e.selectedEquipment.equipmentCode,""),l(4),f(" ",e.selectedEquipment==null?null:e.selectedEquipment.name,""),l(4),b("ngModel",e.actionReason),l(),c("ngIf",e.actionError),l(2),c("disabled",e.actionLoading),l(2),c("disabled",e.actionLoading),l(),f(" ",e.actionLoading?"Processing...":"Put on Hold"," ")}}var U=(()=>{class o{constructor(e){this.apiService=e,this.equipment=[],this.loading=!0,this.page=0,this.size=20,this.totalElements=0,this.totalPages=0,this.hasNext=!1,this.hasPrevious=!1,this.filterStatus="",this.filterType="",this.searchTerm="",this.showMaintenanceModal=!1,this.showHoldModal=!1,this.selectedEquipment=null,this.actionReason="",this.expectedEndTime="",this.actionLoading=!1,this.actionError=""}ngOnInit(){this.loadEquipment()}loadEquipment(){this.loading=!0;let e={page:this.page,size:this.size,sortBy:"equipmentCode",sortDirection:"ASC",status:this.filterStatus||void 0,type:this.filterType||void 0,search:this.searchTerm||void 0};this.apiService.getEquipmentPaged(e).subscribe({next:r=>{this.equipment=r.content,this.page=r.page,this.size=r.size,this.totalElements=r.totalElements,this.totalPages=r.totalPages,this.hasNext=r.hasNext,this.hasPrevious=r.hasPrevious,this.loading=!1},error:r=>{console.error("Error loading equipment:",r),this.loading=!1}})}onPageChange(e){this.page=e,this.loadEquipment()}onSizeChange(e){this.size=e,this.page=0,this.loadEquipment()}onFilterStatusChange(e){this.filterStatus=e==="all"?"":e,this.page=0,this.loadEquipment()}onFilterTypeChange(e){this.filterType=e==="all"?"":e,this.page=0,this.loadEquipment()}onSearchChange(e){this.searchTerm=e,this.page=0,this.loadEquipment()}openMaintenanceModal(e){this.selectedEquipment=e,this.actionReason="",this.expectedEndTime="",this.actionError="",this.showMaintenanceModal=!0}closeMaintenanceModal(){this.showMaintenanceModal=!1,this.selectedEquipment=null,this.actionReason="",this.expectedEndTime="",this.actionError=""}confirmStartMaintenance(){if(!this.actionReason.trim()){this.actionError="Please provide a reason for maintenance.";return}this.selectedEquipment&&(this.actionLoading=!0,this.actionError="",this.apiService.startEquipmentMaintenance(this.selectedEquipment.equipmentId,this.actionReason,this.expectedEndTime||void 0).subscribe({next:()=>{this.actionLoading=!1,this.closeMaintenanceModal(),this.loadEquipment()},error:e=>{this.actionLoading=!1,this.actionError=e.error?.message||"Failed to start maintenance."}}))}endMaintenance(e){confirm(`End maintenance for ${e.equipmentCode}?`)&&(this.loading=!0,this.apiService.endEquipmentMaintenance(e.equipmentId).subscribe({next:()=>{this.loadEquipment()},error:r=>{this.loading=!1,alert(r.error?.message||"Failed to end maintenance.")}}))}openHoldModal(e){this.selectedEquipment=e,this.actionReason="",this.actionError="",this.showHoldModal=!0}closeHoldModal(){this.showHoldModal=!1,this.selectedEquipment=null,this.actionReason="",this.actionError=""}confirmPutOnHold(){if(!this.actionReason.trim()){this.actionError="Please provide a reason for putting on hold.";return}this.selectedEquipment&&(this.actionLoading=!0,this.actionError="",this.apiService.putEquipmentOnHold(this.selectedEquipment.equipmentId,this.actionReason).subscribe({next:()=>{this.actionLoading=!1,this.closeHoldModal(),this.loadEquipment()},error:e=>{this.actionLoading=!1,this.actionError=e.error?.message||"Failed to put equipment on hold."}}))}releaseFromHold(e){confirm(`Release ${e.equipmentCode} from hold?`)&&(this.loading=!0,this.apiService.releaseEquipmentFromHold(e.equipmentId).subscribe({next:()=>{this.loadEquipment()},error:r=>{this.loading=!1,alert(r.error?.message||"Failed to release equipment from hold.")}}))}canStartMaintenance(e){return e.status==="AVAILABLE"||e.status==="ON_HOLD"}canEndMaintenance(e){return e.status==="MAINTENANCE"}canPutOnHold(e){return e.status==="AVAILABLE"||e.status==="MAINTENANCE"}canReleaseFromHold(e){return e.status==="ON_HOLD"}static{this.\u0275fac=function(r){return new(r||o)(P(H))}}static{this.\u0275cmp=w({type:o,selectors:[["app-equipment-list"]],decls:9,vars:4,consts:[[1,"container"],[1,"page-header"],[1,"page-title"],["class","text-center",4,"ngIf"],[4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"text-center"],["message","Loading equipment..."],[1,"card"],[1,"filters"],[1,"filter-group"],[3,"change","value"],["value","all"],["value","AVAILABLE"],["value","IN_USE"],["value","MAINTENANCE"],["value","ON_HOLD"],["value","UNAVAILABLE"],["value","FURNACE"],["value","CASTER"],["value","ROLLING_MILL"],["value","BATCH"],[1,"filter-group","search-group"],["type","text","placeholder","Search by code or name...",3,"input","value"],["class","table",4,"ngIf"],["class","no-data",4,"ngIf"],[3,"page","size","totalElements","totalPages","hasNext","hasPrevious","pageChange","sizeChange",4,"ngIf"],[1,"table"],[4,"ngFor","ngForOf"],[3,"status"],["class","reason-text",4,"ngIf"],[1,"actions-cell"],["class","btn btn-small btn-warning",3,"click",4,"ngIf"],["class","btn btn-small btn-success",3,"click",4,"ngIf"],["class","btn btn-small btn-secondary",3,"click",4,"ngIf"],["class","btn btn-small btn-info",3,"click",4,"ngIf"],["class","no-actions",4,"ngIf"],[1,"reason-text"],[1,"btn","btn-small","btn-warning",3,"click"],[1,"btn","btn-small","btn-success",3,"click"],[1,"btn","btn-small","btn-secondary",3,"click"],[1,"btn","btn-small","btn-info",3,"click"],[1,"no-actions"],[1,"no-data"],[3,"pageChange","sizeChange","page","size","totalElements","totalPages","hasNext","hasPrevious"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"close-btn",3,"click"],[1,"modal-body"],[1,"form-group"],["for","maintenanceReason"],["id","maintenanceReason","placeholder","Enter reason for maintenance...","rows","3",3,"ngModelChange","ngModel"],["for","expectedEndTime"],["type","datetime-local","id","expectedEndTime",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click","disabled"],[1,"btn","btn-warning",3,"click","disabled"],[1,"error-message"],["for","holdReason"],["id","holdReason","placeholder","Enter reason for putting equipment on hold...","rows","3",3,"ngModelChange","ngModel"]],template:function(r,a){r&1&&(v(0,"app-header"),n(1,"div",0)(2,"div",1)(3,"h1",2),i(4,"Equipment Management"),t()(),g(5,Z,2,0,"div",3)(6,re,41,6,"div",4),t(),g(7,se,32,8,"div",5)(8,de,28,7,"div",5)),r&2&&(l(5),c("ngIf",a.loading),l(),c("ngIf",!a.loading),l(),c("ngIf",a.showMaintenanceModal),l(),c("ngIf",a.showHoldModal))},dependencies:[O,L,N,R,I,V,k,z,F,B,D],styles:[".summary-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:20px;flex-wrap:wrap}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:16px 24px;display:flex;flex-direction:column;align-items:center;min-width:120px}.summary-label[_ngcontent-%COMP%]{font-size:12px;color:#888;text-transform:uppercase}.summary-value[_ngcontent-%COMP%]{font-size:24px;font-weight:500;color:#333}.filters[_ngcontent-%COMP%]{display:flex;gap:24px;flex-wrap:wrap}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:#666}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2}.search-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:250px}.actions-cell[_ngcontent-%COMP%]{white-space:nowrap}.btn-small[_ngcontent-%COMP%]{padding:4px 8px;font-size:12px;margin-right:4px;margin-bottom:4px}.btn-warning[_ngcontent-%COMP%]{background-color:#ff9800;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#f57c00}.btn-success[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-success[_ngcontent-%COMP%]:hover{background-color:#388e3c}.btn-secondary[_ngcontent-%COMP%]{background-color:#9e9e9e;color:#fff;border:none;border-radius:4px;cursor:pointer;padding:8px 16px}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#757575}.btn-info[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff;border:none;border-radius:4px;cursor:pointer}.btn-info[_ngcontent-%COMP%]:hover{background-color:#1976d2}.no-actions[_ngcontent-%COMP%]{color:#999;font-style:italic}.reason-text[_ngcontent-%COMP%]{font-size:11px;color:#666;margin-top:4px;font-style:italic}.no-data[_ngcontent-%COMP%]{text-align:center;color:#888;padding:40px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:100%;max-width:500px;box-shadow:0 4px 20px #00000026}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid #e0e0e0}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#999}.close-btn[_ngcontent-%COMP%]:hover{color:#333}.modal-body[_ngcontent-%COMP%]{padding:20px}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0}.form-group[_ngcontent-%COMP%]{margin-top:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;padding:16px 20px;border-top:1px solid #e0e0e0}.modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:8px 16px}.error-message[_ngcontent-%COMP%]{color:#c62828;background-color:#ffebee;padding:10px;border-radius:4px;margin-top:16px}@media (max-width: 768px){.filters[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.search-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.modal[_ngcontent-%COMP%]{margin:20px}}"]})}}return o})();var pe=[{path:"",component:U}],$=(()=>{class o{static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275mod=C({type:o})}static{this.\u0275inj=E({imports:[q.forChild(pe),q]})}}return o})();var Le=(()=>{class o{static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275mod=C({type:o})}static{this.\u0275inj=E({imports:[T,A,$,W]})}}return o})();export{Le as EquipmentModule};
